#include "ReadSkim.h"
/////
//   Main function
/////
void ReadSkim(const char * Input = "", const char * Output =""){
 // define signal or bkg
 if(string(Output).find("ttHwgt") != std::string::npos)wgt = "ttH";
 if(string(Output).find("TTW_") != std::string::npos)evtwgt = 0.21;
 if(string(Output).find("TTH_") != std::string::npos)evtwgt = 0.4176* 0.5071;
 if(string(Output).find("TT_") != std::string::npos)evtwgt = 832;
 cout << "regwgt == " << regwgt<<endl;
 //Call input file
 TFile *inputfile = TFile::Open(Input);
 TTree *readingtree = new TTree("readingtree","readingtree"); readingtree = (TTree*) inputfile->Get("BOOM");
 rSetBranchAddress(readingtree);
 //Define output file
 TFile *newfile = new TFile(Output,"recreate");
 TTree* newtree = new TTree("BOOM","BOOM");
 newtree->SetMaxTreeSize(99000000000);
 wSetBranchAddress(newtree);
 set_wgtMVA();
 //Fill new branches
 int nen = nentries; if(nentries==-1) nen = readingtree->GetEntries();
 for(Int_t en=0; en<nen; en++){
  //Ini
  wClearInitialization();
  Long64_t tentry = readingtree->LoadTree(en); 
  rGetEntry(tentry);
  //if(!((rLeph_Gen_pt->size()==1)&&(rH_Gen_pt->size()!=0)&&(rJeth_Gen_pt->size()==2)))continue;
  //if(!(rnum_Jet_matchMediumHJet>=2))continue;
  wBranch();
  bdtJet_sel(-0.4, 0, 0.4);
  bdtJet_arrange();
  bdtJetPair_sel();
  JetPair_arrange();
  HBDTsync();
  //reg_sel();
  //reglv_sel();
  //reg_read();
  //reglv_read();
  //if(!(num_ishlep==1&&num_ishPair==1&&rH_Gen_pt->size()==1))continue;
  //if(!(tagJetPair_BDT->at(0)>0.6&&tagJetPair_j0bdt->at(0)>0.2&&tagJetPair_j1bdt->at(0)>-0.5))continue;
  //Fill tree
  newtree->Fill();
 }
 //Save new file
 newfile->cd();
 newfile->Write();
 newfile->Close();
} 
/////
//   Analysis functions
/////
//utils
double deltaPhi(double phi1, double phi2){
 double result = phi1 - phi2;
 while (result > M_PI) result -= 2*M_PI;
 while (result <= -M_PI) result += 2*M_PI;
 return result;
}
double deltaEta(double eta1, double eta2){
 return (eta1-eta2);
};
double deltaR(double dphi, double deta){
 return sqrt(pow(dphi,2)+pow(deta,2));
};
double getMTlepmet(double phi1, double phi2, double pt1, double pt2){
 double Mass =0;
 Mass = sqrt(2*pt1*pt2*(1-cos(deltaPhi(phi1,phi2))));
 return Mass;
};
void set_wgtMVA(){
 //ReadJetMVA
 readerjet = new TMVA::Reader("!Color:!Silent");
 readerjet->AddVariable("Jet_lepdrmin",&jetvarlepdrmin);
 //readerjet->AddVariable("Jet_pfCombinedMVAV2BJetTags",&jetvarpfCombinedMVAV2BJetTags);
 readerjet->AddVariable("Jet_pfCombinedInclusiveSecondaryVertexV2BJetTags",&jetvarpfCombinedInclusiveSecondaryVertexV2BJetTags);
 readerjet->AddVariable("Jet_qg",&jetvarqg);
 readerjet->AddVariable("Jet_lepdrmax",&jetvarlepdrmax);
 readerjet->AddVariable("Jet_pt",&jetvarpt);
 cout<< "weight="<<wgt<<"bkg="<<bkg << endl;
 //readerjet->BookMVA("BDTG method", "/afs/cern.ch/work/b/binghuan/private/TTHLep2015/syn/Sample8020/weights_IHEP/Hj_BDTG.weights.xml");
 readerjet->BookMVA("BDTG method", "/afs/cern.ch/work/b/binghuan/private/TTHLep2015/syn/Sample8020/weights_IHEP/Hj_csv_BDTG.weights.xml");
 //ReadJPair MVA
 readerpair = new TMVA::Reader("!Color:!Silent");
 readerpair->AddVariable("bdtJetPair_minlepmass",&pairvarminlepmass);
 readerpair->AddVariable("bdtJetPair_sumbdt",&pairvarsumbdt);
 readerpair->AddVariable("bdtJetPair_dr",&pairvardr);
 readerpair->AddVariable("bdtJetPair_minjdr",&pairvarminjdr);
 readerpair->AddVariable("bdtJetPair_mass",&pairvarmass);
 readerpair->AddVariable("bdtJetPair_minjOvermaxjdr",&pairvarminjOvermaxjdr);
 readerpair->BookMVA("BDTG method", "/afs/cern.ch/work/b/binghuan/private/TTHLep2015/syn/Sample8020/weights_IHEP/Hjj_csv_BDTG.weights.xml");
};
double get_JetMVA(int curr_en){
 jetvarqg = Jet_qg->at(curr_en);
 jetvaraxis2 = Jet_axis2->at(curr_en);
 jetvarptD = Jet_ptD->at(curr_en);
 jetvarmult = Jet_mult->at(curr_en);
 jetvardilepdphi = Jet_dilepdphi->at(curr_en);
 jetvarlepdphimin = Jet_lepdphimin->at(curr_en);
 jetvarnonjdphi = Jet_nonjdphi->at(curr_en);
 jetvarlepdetamax = Jet_lepdetamax->at(curr_en);
 jetvarlepdetamin = Jet_lepdetamin->at(curr_en);
 jetvardilepdr = Jet_dilepdr->at(curr_en);
 jetvarlepdrmax = Jet_lepdrmax->at(curr_en);
 jetvarmass = Jet_mass->at(curr_en);
 jetvarpx = Jet_px->at(curr_en);
 jetvarpy = Jet_py->at(curr_en);
 jetvarpz = Jet_pz->at(curr_en);
 jetvarenergy = Jet_energy->at(curr_en);
 jetvarpt = Jet_pt->at(curr_en);
 jetvareta = Jet_eta->at(curr_en);
 jetvarlepdrmin = Jet_lepdrmin->at(curr_en);
 jetvarbjptratio = Jet_bjptratio->at(curr_en);
 jetvardilepptratio = Jet_dilepptratio->at(curr_en);
 jetvarnonjdilepptratio = Jet_nonjdilepptratio->at(curr_en);
 jetvarnonjptratio = Jet_nonjptratio->at(curr_en);
 jetvarlepdphimax = Jet_lepdphimax->at(curr_en);
 jetvarbjdeta = Jet_bjdeta->at(curr_en);
 jetvardilepdeta = Jet_dilepdeta->at(curr_en);
 jetvarnonjdeta = Jet_nonjdeta->at(curr_en);
 jetvarbjdr = Jet_bjdr->at(curr_en);
 jetvarnonjdr = Jet_nonjdr->at(curr_en);
 jetvarmetptratio = Jet_metptratio->at(curr_en);
 jetvarchargedMultiplicity = Jet_chargedMultiplicity->at(curr_en);
 jetvarnumberOfConstituents = Jet_numberOfConstituents->at(curr_en);
 jetvarchargedHadronEnergyFraction = Jet_chargedHadronEnergyFraction->at(curr_en);
 jetvarpfCombinedMVAV2BJetTags = Jet_pfCombinedMVAV2BJetTags->at(curr_en);
 jetvarpfCombinedInclusiveSecondaryVertexV2BJetTags = Jet_pfCombinedInclusiveSecondaryVertexV2BJetTags->at(curr_en);
 
 return readerjet->EvaluateMVA("BDTG method");
}
double get_PairMVA(int curr_en){
 pairvarenergy =bdtJetPair_energy->at(curr_en);
 pairvardr =bdtJetPair_dr->at(curr_en);
 pairvardeta =bdtJetPair_deta->at(curr_en);
 pairvardphi =bdtJetPair_dphi->at(curr_en);
 pairvarmass =bdtJetPair_mass->at(curr_en);
 pairvarhigestbdt =bdtJetPair_higestbdt->at(curr_en);
 pairvarsumcsv =bdtJetPair_sumcsv->at(curr_en);
 pairvarsumbdt =bdtJetPair_sumbdt->at(curr_en);
 pairvarsumqg =bdtJetPair_sumqg->at(curr_en);
 pairvarptratio =bdtJetPair_ptratio->at(curr_en);
 pairvarWChi2 =bdtJetPair_WChi2->at(curr_en);
 pairvarminlepdr =bdtJetPair_minlepdr->at(curr_en);
 pairvarminlepdeta =bdtJetPair_minlepdeta->at(curr_en);
 pairvarminlepdphi =bdtJetPair_minlepdphi->at(curr_en);
 pairvarminlepmass =bdtJetPair_minlepmass->at(curr_en);
 pairvarmaxlepdr =bdtJetPair_maxlepdr->at(curr_en);
 pairvarmaxlepdeta =bdtJetPair_maxlepdeta->at(curr_en);
 pairvarmaxlepdphi =bdtJetPair_maxlepdphi->at(curr_en);
 pairvarmaxlepmass =bdtJetPair_maxlepmass->at(curr_en);
 pairvarminjdr =bdtJetPair_minjdr->at(curr_en);
 pairvarminjdeta =bdtJetPair_minjdeta->at(curr_en);
 pairvarminjdphi =bdtJetPair_minjdphi->at(curr_en);
 pairvarminjmass =bdtJetPair_minjmass->at(curr_en);
 pairvarmaxjdr =bdtJetPair_maxjdr->at(curr_en);
 pairvarmaxjmass =bdtJetPair_maxjmass->at(curr_en);
 pairvarmaxjdeta =bdtJetPair_maxjdeta->at(curr_en);
 pairvarremaincsvj0mass =bdtJetPair_remaincsvj0mass->at(curr_en);
 pairvarremaincsvj1mass =bdtJetPair_remaincsvj1mass->at(curr_en);
 pairvarremaincsvj0deta =bdtJetPair_remaincsvj0deta->at(curr_en);
 pairvarminjOvermaxjdr =bdtJetPair_minjOvermaxjdr->at(curr_en);
 pairvarjTopminChi2 =bdtJetPair_jTopminChi2->at(curr_en);

 return readerpair->EvaluateMVA("BDTG method");
}
//Obj selection
void bdtJet_sel(double loose, double medium, double tight){
 for(uint jet_en=0; jet_en < Jet_pt->size(); jet_en++){
  double BDTOutput = -2;
  if((Jet_istophJet->at(jet_en)==0&&bkg=="ttH"&&phase=="TopClean")||(Jet_ishighestcsv->at(jet_en)==0&&bkg=="ttH"&&phase=="bClean")||(bkg=="ttH"&&phase=="Inclusive")||bkg!="ttH"){
   BDTOutput = get_JetMVA(jet_en);
  }
  Jet_BDT->push_back(BDTOutput);
 }
}; 
void bdtJet_arrange(){
 if (Jet_pt->size()>=1){
  bdtJet_BDT->push_back(Jet_BDT->at(0));
  bdtJet_ishighestcsv->push_back(Jet_ishighestcsv->at(0));
  bdtJet_istophJet->push_back(Jet_istophJet->at(0));
  bdtJet_isLooseHJet->push_back(Jet_isLooseHJet->at(0));
  bdtJet_isMediumHJet->push_back(Jet_isMediumHJet->at(0));
  bdtJet_isTightHJet->push_back(Jet_isTightHJet->at(0));
  bdtJet_pt->push_back(Jet_pt->at(0));
  bdtJet_eta->push_back(Jet_eta->at(0));
  bdtJet_phi->push_back(Jet_phi->at(0));
  bdtJet_energy->push_back(Jet_energy->at(0));
  bdtJet_qg->push_back(Jet_qg->at(0));
  bdtJet_newpfCombinedInclusiveSecondaryVertexV2BJetTags->push_back(Jet_newpfCombinedInclusiveSecondaryVertexV2BJetTags->at(0));
  bdtJet_lepdrmin->push_back(Jet_lepdrmin->at(0));
  bdtJet_pfCombinedMVAV2BJetTags->push_back(Jet_pfCombinedMVAV2BJetTags->at(0));
  bdtJet_lepdrmax->push_back(Jet_lepdrmax->at(0));
  if (Jet_pt->size()>=2){
   for(uint jet_en = 1; jet_en<Jet_pt->size(); jet_en++){
    double jet_bdt =  Jet_BDT->at(jet_en);
    bool inserted = false;
    int index = 0 ;
    for(auto it = bdtJet_BDT->begin(); it != bdtJet_BDT->end(); ++it){ 
     double jet_currbdt = *it;
     auto it_bdtJet_ishighestcsv = bdtJet_ishighestcsv->begin();
     auto it_bdtJet_istophJet = bdtJet_istophJet->begin();
     auto it_bdtJet_isLooseHJet = bdtJet_isLooseHJet->begin();
     auto it_bdtJet_isMediumHJet = bdtJet_isMediumHJet->begin();
     auto it_bdtJet_isTightHJet = bdtJet_isTightHJet->begin();
     auto it_bdtJet_pt = bdtJet_pt->begin();
     auto it_bdtJet_eta = bdtJet_eta->begin();
     auto it_bdtJet_phi = bdtJet_phi->begin();
     auto it_bdtJet_energy = bdtJet_energy->begin();
     auto it_bdtJet_qg = bdtJet_qg->begin();
     auto it_bdtJet_newpfCombinedInclusiveSecondaryVertexV2BJetTags = bdtJet_newpfCombinedInclusiveSecondaryVertexV2BJetTags->begin();
     auto it_bdtJet_lepdrmin = bdtJet_lepdrmin->begin();
     auto it_bdtJet_pfCombinedMVAV2BJetTags = bdtJet_pfCombinedMVAV2BJetTags->begin();
     auto it_bdtJet_lepdrmax = bdtJet_lepdrmax->begin();
     if(jet_bdt>jet_currbdt){
      bdtJet_BDT->insert(it,jet_bdt);
      bdtJet_ishighestcsv->insert(it_bdtJet_ishighestcsv+index,Jet_ishighestcsv->at(jet_en));
      bdtJet_istophJet->insert(it_bdtJet_istophJet+index,Jet_istophJet->at(jet_en));
      bdtJet_isLooseHJet->insert(it_bdtJet_isLooseHJet+index,Jet_isLooseHJet->at(jet_en));
      bdtJet_isMediumHJet->insert(it_bdtJet_isMediumHJet+index,Jet_isMediumHJet->at(jet_en));
      bdtJet_isTightHJet->insert(it_bdtJet_isTightHJet+index,Jet_isTightHJet->at(jet_en));
      bdtJet_pt->insert(it_bdtJet_pt+index,Jet_pt->at(jet_en));
      bdtJet_eta->insert(it_bdtJet_eta+index,Jet_eta->at(jet_en));
      bdtJet_phi->insert(it_bdtJet_phi+index,Jet_phi->at(jet_en));
      bdtJet_energy->insert(it_bdtJet_energy+index,Jet_energy->at(jet_en));
      bdtJet_qg->insert(it_bdtJet_qg+index,Jet_qg->at(jet_en));
      bdtJet_newpfCombinedInclusiveSecondaryVertexV2BJetTags->insert(it_bdtJet_newpfCombinedInclusiveSecondaryVertexV2BJetTags+index,Jet_newpfCombinedInclusiveSecondaryVertexV2BJetTags->at(jet_en));
      bdtJet_lepdrmin->insert(it_bdtJet_lepdrmin+index,Jet_lepdrmin->at(jet_en));
      bdtJet_pfCombinedMVAV2BJetTags->insert(it_bdtJet_pfCombinedMVAV2BJetTags+index,Jet_pfCombinedMVAV2BJetTags->at(jet_en));
      bdtJet_lepdrmax->insert(it_bdtJet_lepdrmax+index,Jet_lepdrmax->at(jet_en));
      inserted = true;
      break;
     }
     index++;
    }
    if(!inserted){
     bdtJet_BDT->push_back(jet_bdt);
     bdtJet_ishighestcsv->push_back(Jet_ishighestcsv->at(jet_en));
     bdtJet_istophJet->push_back(Jet_istophJet->at(jet_en));
     bdtJet_isLooseHJet->push_back(Jet_isLooseHJet->at(jet_en));
     bdtJet_isMediumHJet->push_back(Jet_isMediumHJet->at(jet_en));
     bdtJet_isTightHJet->push_back(Jet_isTightHJet->at(jet_en));
     bdtJet_pt->push_back(Jet_pt->at(jet_en));
     bdtJet_eta->push_back(Jet_eta->at(jet_en));
     bdtJet_phi->push_back(Jet_phi->at(jet_en));
     bdtJet_energy->push_back(Jet_energy->at(jet_en));
     bdtJet_qg->push_back(Jet_qg->at(jet_en));
     bdtJet_newpfCombinedInclusiveSecondaryVertexV2BJetTags->push_back(Jet_newpfCombinedInclusiveSecondaryVertexV2BJetTags->at(jet_en));
     bdtJet_lepdrmin->push_back(Jet_lepdrmin->at(jet_en));
     bdtJet_pfCombinedMVAV2BJetTags->push_back(Jet_pfCombinedMVAV2BJetTags->at(jet_en));
     bdtJet_lepdrmax->push_back(Jet_lepdrmax->at(jet_en));
    }
   }
  }
 }
};
//JetPair
void bdtJetPair_sel(){
 int curr_jet1 = 1;
 int curr_jet2 = 0;
 TLorentzVector Lep1={0,0,0,0};
 TLorentzVector Lep2={0,0,0,0};
 Lep1.SetPtEtaPhiE(FakeLep_pt->at(0),FakeLep_eta->at(0),FakeLep_phi->at(0),FakeLep_energy->at(0));
 Lep2.SetPtEtaPhiE(FakeLep_pt->at(1),FakeLep_eta->at(1),FakeLep_phi->at(1),FakeLep_energy->at(1));
 //double Num_Jet= (Jet_pt->size() < 4) ? Jet_pt->size() : 4;
 double Num_Jet= Jet_pt->size();
 double Num_hjetpair =0; 
 for(uint bjet_en =0; bjet_en<Num_Jet; bjet_en++){
  TLorentzVector Curr_Jet1={0,0,0,0};
  Curr_Jet1.SetPtEtaPhiE(Jet_pt->at(bjet_en),Jet_eta->at(bjet_en),Jet_phi->at(bjet_en),Jet_energy->at(bjet_en));
  curr_jet1 = bjet_en+1;
  for(uint bj_en=bjet_en+1; bj_en< Num_Jet; bj_en++){
   curr_jet2 = bj_en +1;
   double curr_id = 100*curr_jet1 + curr_jet2;
   TLorentzVector Curr_Jet2={0,0,0,0};
   TLorentzVector DiJet={0,0,0,0};
   TLorentzVector Lepmin={0,0,0,0};
   TLorentzVector Lepmax={0,0,0,0};
   TLorentzVector Lvmin={0,0,0,0};
   TLorentzVector Lvmax={0,0,0,0};
   TLorentzVector Jetmin={0,0,0,0};
   TLorentzVector Jetmax={0,0,0,0};
   TLorentzVector restcsvJet0={0,0,0,0};
   TLorentzVector restcsvJet1={0,0,0,0};
   TLorentzVector TopminChi2Jet={0,0,0,0};
   Curr_Jet2.SetPtEtaPhiE(Jet_pt->at(bj_en),Jet_eta->at(bj_en),Jet_phi->at(bj_en),Jet_energy->at(bj_en));
   DiJet = Curr_Jet1 + Curr_Jet2;
   //find lepmin lepmax
   double minlepishlep = -1;
   double maxlepishlep = -1;
   if( deltaR(deltaPhi(DiJet.Phi(),Lep1.Phi()),deltaEta(DiJet.Eta(),Lep1.Eta())) > deltaR(deltaPhi(DiJet.Phi(),Lep2.Phi()),deltaEta(DiJet.Eta(),Lep2.Eta()))){
    Lepmin.SetPtEtaPhiE(Lep2.Pt(),Lep2.Eta(),Lep2.Phi(),Lep2.E());
    Lepmax.SetPtEtaPhiE(Lep1.Pt(),Lep1.Eta(),Lep1.Phi(),Lep1.E());
    minlepishlep = FakeLep_ishlep->at(1);
    maxlepishlep = FakeLep_ishlep->at(0);
   }else{
    Lepmin.SetPtEtaPhiE(Lep1.Pt(),Lep1.Eta(),Lep1.Phi(),Lep1.E());
    Lepmax.SetPtEtaPhiE(Lep2.Pt(),Lep2.Eta(),Lep2.Phi(),Lep2.E());
    minlepishlep = FakeLep_ishlep->at(0);
    maxlepishlep = FakeLep_ishlep->at(1);
   }
   //find gen lepmin lepmax
   int index_genlepmin = -1;
   int index_genlepmax = -1;
   double dr_minlep = 999;
   double dr_maxlep = 999;
   for(uint gen_en=0; gen_en<Gen_pt->size(); gen_en++){
    if(!((fabs(Gen_pdg_id->at(gen_en))==11 || fabs(Gen_pdg_id->at(gen_en))==13) && !(Gen_pdg_id->at(gen_en)==Gen_motherpdg_id->at(gen_en))))continue;
    double curr_minlepdr =deltaR(deltaPhi(Lepmin.Phi(),Gen_phi->at(gen_en)),deltaEta(Lepmin.Eta(),Gen_eta->at(gen_en)));
    double curr_maxlepdr =deltaR(deltaPhi(Lepmax.Phi(),Gen_phi->at(gen_en)),deltaEta(Lepmax.Eta(),Gen_eta->at(gen_en)));
    if(curr_minlepdr<dr_minlep){
     index_genlepmin = gen_en;
     dr_minlep = curr_minlepdr;
    }
    if(curr_maxlepdr<dr_maxlep){
     index_genlepmax = gen_en;
     dr_maxlep = curr_maxlepdr;
    }
   }
   //find gen lvmin lvmax
   Lvmin.SetPtEtaPhiE(0,0,0,0);
   Lvmax.SetPtEtaPhiE(0,0,0,0);
   int index_genlvmin = -1;
   int index_genlvmax = -1;
   for(uint gen_en=0; gen_en<Gen_pt->size(); gen_en++){
    if(!(fabs(Gen_pdg_id->at(gen_en))-1==fabs(Gen_pdg_id->at(index_genlepmin))&& Gen_BmotherIndex->at(gen_en)==Gen_BmotherIndex->at(index_genlepmin)))continue;
    Lvmin.SetPtEtaPhiE(Gen_pt->at(gen_en),Gen_eta->at(gen_en),Gen_phi->at(gen_en),Gen_energy->at(gen_en));
    index_genlvmin = gen_en;
   } 
   for(uint gen_en=0; gen_en<Gen_pt->size(); gen_en++){
    if(!(fabs(Gen_pdg_id->at(gen_en))-1==fabs(Gen_pdg_id->at(index_genlepmax))&& Gen_BmotherIndex->at(gen_en)==Gen_BmotherIndex->at(index_genlepmax)))continue;
    Lvmax.SetPtEtaPhiE(Gen_pt->at(gen_en),Gen_eta->at(gen_en),Gen_phi->at(gen_en),Gen_energy->at(gen_en));
    index_genlvmax = gen_en;
   } 
   //find jetmin jetmax
   double maxdr=0;
   double mindr=999;
   double minChi2=999999;
   int index_max = -1;
   int index_min = -1;
   int index_chi2 = -1;
   for(uint rj_en=0; rj_en<Jet_pt->size(); rj_en++){
    if(rj_en==bj_en||rj_en==bjet_en)continue;
    TLorentzVector rJet={0,0,0,0};
    rJet.SetPtEtaPhiE(Jet_pt->at(rj_en),Jet_eta->at(rj_en),Jet_phi->at(rj_en),Jet_energy->at(rj_en));
    double currdr =deltaR(deltaPhi(DiJet.Phi(),rJet.Phi()),deltaEta(DiJet.Eta(),rJet.Eta()));
    double currChi2 = pow(((DiJet+rJet).M()-173.34)/50,2);
    if(currdr>maxdr){
     index_max = rj_en;
     maxdr = currdr;
    }
    if(currdr<mindr){
     index_min = rj_en;
     mindr = currdr;
    }
    if(currChi2<minChi2){
     index_chi2 = rj_en;
     minChi2 = currChi2;
    }
   }
   Jetmin.SetPtEtaPhiE(Jet_pt->at(index_min),Jet_eta->at(index_min),Jet_phi->at(index_min),Jet_energy->at(index_min));
   Jetmax.SetPtEtaPhiE(Jet_pt->at(index_max),Jet_eta->at(index_max),Jet_phi->at(index_max),Jet_energy->at(index_max));
   TopminChi2Jet.SetPtEtaPhiE(Jet_pt->at(index_chi2),Jet_eta->at(index_chi2),Jet_phi->at(index_chi2),Jet_energy->at(index_chi2));
   //find restcsvjet
   bool csvjet0 =0;
   bool csvjet1 =0;
   for(uint cj_en=0; cj_en<csvJet_pt->size(); cj_en++){
    TLorentzVector cJet={0,0,0,0};
    cJet.SetPtEtaPhiE(csvJet_pt->at(cj_en),csvJet_eta->at(cj_en),csvJet_phi->at(cj_en),csvJet_energy->at(cj_en));
    if(cJet==Curr_Jet2||cJet==Curr_Jet1)continue;
    if(rEVENT_event == 812452 && debug ){
     cout << " currId = " << curr_id << " curr_jet1.pt "<< Curr_Jet1.Pt()<< " curr_jet2.pt "<< Curr_Jet2.Pt()<< " restcsvjet0.pt " << restcsvJet0.Pt() << " restcsvjet1.pt "<< restcsvJet1.Pt()<< " rEVENT_event "<< rEVENT_event <<" cjet.pt "  <<cJet.Pt() <<endl;
    }
    if(!csvjet0){
     restcsvJet0.SetPtEtaPhiE(csvJet_pt->at(cj_en),csvJet_eta->at(cj_en),csvJet_phi->at(cj_en),csvJet_energy->at(cj_en));
     csvjet0 =1;
     continue;
    }
    if(csvjet0 && !csvjet1){
     restcsvJet1.SetPtEtaPhiE(csvJet_pt->at(cj_en),csvJet_eta->at(cj_en),csvJet_phi->at(cj_en),csvJet_energy->at(cj_en));
     csvjet1 =1;
    }
    if(csvjet0&&csvjet1)break;
   }
   if(rEVENT_event == 812452 && debug){
    cout << " currId = " << curr_id << " curr_jet1.pt "<< Curr_Jet1.Pt()<< " curr_jet2.pt "<< Curr_Jet2.Pt()<< " restcsvjet0.pt " << restcsvJet0.Pt() << " restcsvjet1.pt "<< restcsvJet1.Pt()<< " rEVENT_event "<< rEVENT_event <<endl;
   }
   //Fill JetPair
   double ishpair =0;
   double hascsvj0 =0;
   double hastophj =0;
   double highestbdt = ((Jet_BDT->at(bjet_en)) > (Jet_BDT->at(bj_en))) ? (Jet_BDT->at(bjet_en)) : (Jet_BDT->at(bj_en));
   if(Jet_isMediumHJet->at(bjet_en)==1&&Jet_isMediumHJet->at(bj_en)==1)ishpair=1;
   if(Jet_ishighestcsv->at(bjet_en)==1||Jet_ishighestcsv->at(bj_en)==1)hascsvj0=1;
   //cout <<Jet_ishighestcsv->at(bjet_en)<<Jet_ishighestcsv->at(bj_en) << hascsvj0 << endl;
   if((Jet_isMediumHJet->at(bjet_en)!=1&&Jet_istophJet->at(bjet_en)==1)||(Jet_isMediumHJet->at(bj_en)!=1&&Jet_istophJet->at(bj_en)==1))hastophj=1;
   if(ishpair==1)Num_hjetpair++;
   bdtJetPair_id->push_back(curr_id);
   bdtJetPair_pt->push_back(DiJet.Pt());
   bdtJetPair_eta->push_back(DiJet.Eta());
   bdtJetPair_phi->push_back(DiJet.Phi());
   bdtJetPair_energy->push_back(DiJet.E());
   bdtJetPair_ishPair->push_back(ishpair);
   bdtJetPair_hascsvj0->push_back(hascsvj0);
   bdtJetPair_hastophj->push_back(hastophj);
   bdtJetPair_dr->push_back(deltaR(deltaPhi(Curr_Jet1.Phi(),Curr_Jet2.Phi()),deltaEta(Curr_Jet1.Eta(),Curr_Jet2.Eta())));
   bdtJetPair_deta->push_back(deltaEta(Curr_Jet1.Eta(),Curr_Jet2.Eta()));
   bdtJetPair_dphi->push_back(deltaPhi(Curr_Jet1.Phi(),Curr_Jet2.Phi()));
   bdtJetPair_mass->push_back(DiJet.M());
   bdtJetPair_higestbdt->push_back(highestbdt);
   bdtJetPair_sumcsv->push_back(Jet_newpfCombinedInclusiveSecondaryVertexV2BJetTags->at(bjet_en)+Jet_newpfCombinedInclusiveSecondaryVertexV2BJetTags->at(bj_en));
   bdtJetPair_sumbdt->push_back(Jet_BDT->at(bjet_en)+Jet_BDT->at(bj_en));
   bdtJetPair_j0bdt->push_back(Jet_BDT->at(bjet_en));
   bdtJetPair_j1bdt->push_back(Jet_BDT->at(bj_en));
   bdtJetPair_sumqg->push_back(Jet_qg->at(bjet_en)+Jet_qg->at(bj_en));
   bdtJetPair_ptratio->push_back(Curr_Jet1.Pt()/Curr_Jet2.Pt());
   bdtJetPair_WChi2->push_back(pow((DiJet.M()-80.385)/25,2));
   bdtJetPair_minlepdr->push_back(deltaR(deltaPhi(DiJet.Phi(),Lepmin.Phi()),deltaEta(DiJet.Eta(),Lepmin.Eta())));
   bdtJetPair_minlepdeta->push_back(deltaEta(DiJet.Eta(),Lepmin.Eta()));
   bdtJetPair_minlepdphi->push_back(deltaPhi(DiJet.Phi(),Lepmin.Phi()));
   bdtJetPair_minlepmass->push_back((DiJet+Lepmin).M());
   bdtJetPair_minlepptratio->push_back(DiJet.Pt()/Lepmin.Pt());
   bdtJetPair_maxlepdr->push_back(deltaR(deltaPhi(DiJet.Phi(),Lepmax.Phi()),deltaEta(DiJet.Eta(),Lepmax.Eta())));
   bdtJetPair_maxlepdeta->push_back(deltaEta(DiJet.Eta(),Lepmax.Eta()));
   bdtJetPair_maxlepdphi->push_back(deltaPhi(DiJet.Phi(),Lepmax.Phi()));
   bdtJetPair_maxlepmass->push_back((DiJet+Lepmax).M());
   bdtJetPair_maxlepptratio->push_back(DiJet.Pt()/Lepmax.Pt());
   bdtJetPair_minjdr->push_back(deltaR(deltaPhi(DiJet.Phi(),Jetmin.Phi()),deltaEta(DiJet.Eta(),Jetmin.Eta())));
   bdtJetPair_minjdeta->push_back(deltaEta(DiJet.Eta(),Jetmin.Eta()));
   bdtJetPair_minjdphi->push_back(deltaPhi(DiJet.Phi(),Jetmin.Phi()));
   bdtJetPair_minjmass->push_back((DiJet+Jetmin).M());
   bdtJetPair_minjptratio->push_back(DiJet.Pt()/Jetmin.Pt());
   bdtJetPair_maxjdr->push_back(deltaR(deltaPhi(DiJet.Phi(),Jetmax.Phi()),deltaEta(DiJet.Eta(),Jetmax.Eta())));
   bdtJetPair_maxjdeta->push_back(deltaEta(DiJet.Eta(),Jetmax.Eta()));
   bdtJetPair_maxjdphi->push_back(deltaPhi(DiJet.Phi(),Jetmax.Phi()));
   bdtJetPair_maxjmass->push_back((DiJet+Jetmax).M());
   bdtJetPair_maxjptratio->push_back(DiJet.Pt()/Jetmax.Pt());
   bdtJetPair_remaincsvj0dr->push_back(deltaR(deltaPhi(DiJet.Phi(),restcsvJet0.Phi()),deltaEta(DiJet.Eta(),restcsvJet0.Eta())));
   bdtJetPair_remaincsvj0deta->push_back(deltaEta(DiJet.Eta(),restcsvJet0.Eta()));
   bdtJetPair_remaincsvj0dphi->push_back(deltaPhi(DiJet.Phi(),restcsvJet0.Phi()));
   bdtJetPair_remaincsvj0mass->push_back((DiJet+restcsvJet0).M());
   bdtJetPair_remaincsvj0ptratio->push_back(DiJet.Pt()/restcsvJet0.Pt());
   bdtJetPair_remaincsvj1dr->push_back(deltaR(deltaPhi(DiJet.Phi(),restcsvJet1.Phi()),deltaEta(DiJet.Eta(),restcsvJet1.Eta())));
   bdtJetPair_remaincsvj1deta->push_back(deltaEta(DiJet.Eta(),restcsvJet1.Eta()));
   bdtJetPair_remaincsvj1dphi->push_back(deltaPhi(DiJet.Phi(),restcsvJet1.Phi()));
   bdtJetPair_remaincsvj1mass->push_back((DiJet+restcsvJet1).M());
   bdtJetPair_remaincsvj1ptratio->push_back(DiJet.Pt()/restcsvJet1.Pt());
   bdtJetPair_minjOvermaxjdr->push_back(deltaR(deltaPhi(DiJet.Phi(),Jetmin.Phi()),deltaEta(DiJet.Eta(),Jetmin.Eta()))/deltaR(deltaPhi(DiJet.Phi(),Jetmax.Phi()),deltaEta(DiJet.Eta(),Jetmax.Eta())));
   bdtJetPair_jTopminChi2->push_back(minChi2);
   bdtJetPair_TopminChi2jpt->push_back((DiJet+TopminChi2Jet).Pt());
   bdtJetPair_minlepishlep->push_back(minlepishlep);
   bdtJetPair_minleppt->push_back((DiJet+Lepmin).Pt());
   bdtJetPair_minlepeta->push_back((DiJet+Lepmin).Eta());
   bdtJetPair_minlepphi->push_back((DiJet+Lepmin).Phi());
   bdtJetPair_minlepenergy->push_back((DiJet+Lepmin).E());
   bdtJetPair_minlvpt->push_back(Lvmin.Pt());
   bdtJetPair_minlveta->push_back(Lvmin.Eta());
   bdtJetPair_minlvphi->push_back(Lvmin.Phi());
   bdtJetPair_minlvenergy->push_back(Lvmin.E());
   if(index_genlepmin>=0){
    bdtJetPair_minlepmotherIndex->push_back(Gen_BmotherIndex->at(index_genlepmin));
    bdtJetPair_minlepmotherId->push_back(Gen_motherpdg_id->at(index_genlepmin));
   }else{
    bdtJetPair_minlepmotherIndex->push_back(-999);
    bdtJetPair_minlepmotherId->push_back(-999);
   }
   if(index_genlepmax>=0){
    bdtJetPair_maxlepmotherIndex->push_back(Gen_BmotherIndex->at(index_genlepmax));
    bdtJetPair_maxlepmotherId->push_back(Gen_motherpdg_id->at(index_genlepmax));
   }else{
    bdtJetPair_maxlepmotherIndex->push_back(-999);
    bdtJetPair_maxlepmotherId->push_back(-999);
   }
   if(index_genlvmin>=0){
    bdtJetPair_minlvmotherIndex->push_back(Gen_BmotherIndex->at(index_genlvmin));
   }else{
    bdtJetPair_minlvmotherIndex->push_back(-999);
   }
   if(index_genlvmin>=0){
    bdtJetPair_minlvmotherId->push_back(Gen_motherpdg_id->at(index_genlvmin));
   }else{
    bdtJetPair_minlvmotherId->push_back(-999);
   }
   bdtJetPair_maxlepishlep->push_back(maxlepishlep);
   bdtJetPair_maxleppt->push_back((DiJet+Lepmax).Pt());
   bdtJetPair_maxlepeta->push_back((DiJet+Lepmax).Eta());
   bdtJetPair_maxlepphi->push_back((DiJet+Lepmax).Phi());
   bdtJetPair_maxlepenergy->push_back((DiJet+Lepmax).E());
   bdtJetPair_maxlvpt->push_back(Lvmax.Pt());
   bdtJetPair_maxlveta->push_back(Lvmax.Eta());
   bdtJetPair_maxlvphi->push_back(Lvmax.Phi());
   bdtJetPair_maxlvenergy->push_back(Lvmax.E());
   if(index_genlvmax>=0){
    bdtJetPair_maxlvmotherIndex->push_back(Gen_BmotherIndex->at(index_genlvmax));
   }else{
    bdtJetPair_maxlvmotherIndex->push_back(-999);
   }
   if(index_genlvmax>=0){
    bdtJetPair_maxlvmotherId->push_back(Gen_motherpdg_id->at(index_genlvmax));
   }else{
    bdtJetPair_maxlvmotherId->push_back(-999);
   }
  } 
 }
 double maxbdt =-1;
 for(uint jpair_en=0; jpair_en < bdtJetPair_pt->size(); jpair_en++){
  double BDTOutput = -2;
  if((bdtJetPair_hastophj->at(jpair_en)==0&&bkg=="ttH"&&phase=="TopClean")||(bdtJetPair_hascsvj0->at(jpair_en)==0&&bkg=="ttH"&&phase=="bClean")||(bkg=="ttH"&&phase=="Inclusive")||bkg!="ttH"){
  //if((Jet_istophJet->at(jpair_en)==0&&bkg=="ttH"&&TopClean)||(bkg=="ttH"&&!TopClean)||bkg!="ttH"){
   BDTOutput = get_PairMVA(jpair_en);
   if(BDTOutput>maxbdt) maxbdt=BDTOutput;
   //BDTOutput = -999;
  }
  bdtJetPair_BDT->push_back(BDTOutput);
 }
 for(uint jpair_en=0; jpair_en < bdtJetPair_pt->size(); jpair_en++){
  double ismaxbdt =0;
  if(bdtJetPair_BDT->at(jpair_en)>=maxbdt)ismaxbdt=1;
  bdtJetPair_ismaxBDT->push_back(ismaxbdt);
 }
 num_ishPair = Num_hjetpair;
};
void JetPair_arrange(){
 if (bdtJetPair_pt->size()>=1){
  tagJetPair_ishPair->push_back(bdtJetPair_ishPair->at(0));
  tagJetPair_j0bdt->push_back(bdtJetPair_j0bdt->at(0));
  tagJetPair_j1bdt->push_back(bdtJetPair_j1bdt->at(0));
  tagJetPair_hascsvj0->push_back(bdtJetPair_hascsvj0->at(0));
  tagJetPair_hastophj->push_back(bdtJetPair_hastophj->at(0));
  tagJetPair_id->push_back(bdtJetPair_id->at(0));
  tagJetPair_BDT->push_back(bdtJetPair_BDT->at(0));
  tagJetPair_pt->push_back(bdtJetPair_pt->at(0));
  tagJetPair_mass->push_back(bdtJetPair_mass->at(0));
  tagJetPair_eta->push_back(bdtJetPair_eta->at(0));
  tagJetPair_phi->push_back(bdtJetPair_phi->at(0));
  tagJetPair_energy->push_back(bdtJetPair_energy->at(0));
  tagJetPair_dr->push_back(bdtJetPair_dr->at(0));
  tagJetPair_deta->push_back(bdtJetPair_deta->at(0));
  tagJetPair_dphi->push_back(bdtJetPair_dphi->at(0));
  tagJetPair_ismaxBDT->push_back(bdtJetPair_ismaxBDT->at(0));
  tagJetPair_higestbdt->push_back(bdtJetPair_higestbdt->at(0));
  tagJetPair_sumcsv->push_back(bdtJetPair_sumcsv->at(0));
  tagJetPair_sumbdt->push_back(bdtJetPair_sumbdt->at(0));
  tagJetPair_sumqg->push_back(bdtJetPair_sumqg->at(0));
  tagJetPair_ptratio->push_back(bdtJetPair_ptratio->at(0));
  tagJetPair_WChi2->push_back(bdtJetPair_WChi2->at(0));
  tagJetPair_minlepdr->push_back(bdtJetPair_minlepdr->at(0));
  tagJetPair_minlepdeta->push_back(bdtJetPair_minlepdeta->at(0));
  tagJetPair_minlepdphi->push_back(bdtJetPair_minlepdphi->at(0));
  tagJetPair_minlepmass->push_back(bdtJetPair_minlepmass->at(0));
  tagJetPair_minlepptratio->push_back(bdtJetPair_minlepptratio->at(0));
  tagJetPair_maxlepdr->push_back(bdtJetPair_maxlepdr->at(0));
  tagJetPair_maxlepdeta->push_back(bdtJetPair_maxlepdeta->at(0));
  tagJetPair_maxlepdphi->push_back(bdtJetPair_maxlepdphi->at(0));
  tagJetPair_maxlepmass->push_back(bdtJetPair_maxlepmass->at(0));
  tagJetPair_maxlepptratio->push_back(bdtJetPair_maxlepptratio->at(0));
  tagJetPair_minjdr->push_back(bdtJetPair_minjdr->at(0));
  tagJetPair_minjdeta->push_back(bdtJetPair_minjdeta->at(0));
  tagJetPair_minjdphi->push_back(bdtJetPair_minjdphi->at(0));
  tagJetPair_minjmass->push_back(bdtJetPair_minjmass->at(0));
  tagJetPair_minjptratio->push_back(bdtJetPair_minjptratio->at(0));
  tagJetPair_maxjdr->push_back(bdtJetPair_maxjdr->at(0));
  tagJetPair_maxjdeta->push_back(bdtJetPair_maxjdeta->at(0));
  tagJetPair_maxjdphi->push_back(bdtJetPair_maxjdphi->at(0));
  tagJetPair_maxjmass->push_back(bdtJetPair_maxjmass->at(0));
  tagJetPair_maxjptratio->push_back(bdtJetPair_maxjptratio->at(0));
  tagJetPair_remaincsvj0dr->push_back(bdtJetPair_remaincsvj0dr->at(0));
  tagJetPair_remaincsvj0deta->push_back(bdtJetPair_remaincsvj0deta->at(0));
  tagJetPair_remaincsvj0dphi->push_back(bdtJetPair_remaincsvj0dphi->at(0));
  tagJetPair_remaincsvj0mass->push_back(bdtJetPair_remaincsvj0mass->at(0));
  tagJetPair_remaincsvj0ptratio->push_back(bdtJetPair_remaincsvj0ptratio->at(0));
  tagJetPair_remaincsvj1dr->push_back(bdtJetPair_remaincsvj1dr->at(0));
  tagJetPair_remaincsvj1deta->push_back(bdtJetPair_remaincsvj1deta->at(0));
  tagJetPair_remaincsvj1dphi->push_back(bdtJetPair_remaincsvj1dphi->at(0));
  tagJetPair_remaincsvj1mass->push_back(bdtJetPair_remaincsvj1mass->at(0));
  tagJetPair_remaincsvj1ptratio->push_back(bdtJetPair_remaincsvj1ptratio->at(0));
  tagJetPair_minjOvermaxjdr->push_back(bdtJetPair_minjOvermaxjdr->at(0));
  tagJetPair_jTopminChi2->push_back(bdtJetPair_jTopminChi2->at(0));
  tagJetPair_TopminChi2jpt->push_back(bdtJetPair_TopminChi2jpt->at(0));
  tagJetPair_minlepishlep->push_back(bdtJetPair_minlepishlep->at(0));
  tagJetPair_minleppt->push_back(bdtJetPair_minleppt->at(0));
  tagJetPair_minlepeta->push_back(bdtJetPair_minlepeta->at(0));
  tagJetPair_minlepphi->push_back(bdtJetPair_minlepphi->at(0));
  tagJetPair_minlepenergy->push_back(bdtJetPair_minlepenergy->at(0));
  tagJetPair_minlepmotherIndex->push_back(bdtJetPair_minlepmotherIndex->at(0));
  tagJetPair_minlepmotherId->push_back(bdtJetPair_minlepmotherId->at(0));
  tagJetPair_minlvpt->push_back(bdtJetPair_minlvpt->at(0));
  tagJetPair_minlveta->push_back(bdtJetPair_minlveta->at(0));
  tagJetPair_minlvphi->push_back(bdtJetPair_minlvphi->at(0));
  tagJetPair_minlvenergy->push_back(bdtJetPair_minlvenergy->at(0));
  tagJetPair_minlvmotherIndex->push_back(bdtJetPair_minlvmotherIndex->at(0));
  tagJetPair_minlvmotherId->push_back(bdtJetPair_minlvmotherId->at(0));
  tagJetPair_maxlepishlep->push_back(bdtJetPair_maxlepishlep->at(0));
  tagJetPair_maxleppt->push_back(bdtJetPair_maxleppt->at(0));
  tagJetPair_maxlepeta->push_back(bdtJetPair_maxlepeta->at(0));
  tagJetPair_maxlepphi->push_back(bdtJetPair_maxlepphi->at(0));
  tagJetPair_maxlepenergy->push_back(bdtJetPair_maxlepenergy->at(0));
  tagJetPair_maxlepmotherIndex->push_back(bdtJetPair_maxlepmotherIndex->at(0));
  tagJetPair_maxlepmotherId->push_back(bdtJetPair_maxlepmotherId->at(0));
  tagJetPair_maxlvpt->push_back(bdtJetPair_maxlvpt->at(0));
  tagJetPair_maxlveta->push_back(bdtJetPair_maxlveta->at(0));
  tagJetPair_maxlvphi->push_back(bdtJetPair_maxlvphi->at(0));
  tagJetPair_maxlvenergy->push_back(bdtJetPair_maxlvenergy->at(0));
  tagJetPair_maxlvmotherIndex->push_back(bdtJetPair_maxlvmotherIndex->at(0));
  tagJetPair_maxlvmotherId->push_back(bdtJetPair_maxlvmotherId->at(0));
  if (bdtJetPair_pt->size()>=2){
   for(uint pair_en = 1; pair_en<bdtJetPair_pt->size(); pair_en++){
    double pair_bdt =  bdtJetPair_BDT->at(pair_en);
    bool inserted = false;
    int index = 0 ;
    for(auto it = tagJetPair_BDT->begin(); it != tagJetPair_BDT->end(); ++it){ 
     double pair_currbdt = *it;
     auto it_tagJetPair_ishPair = tagJetPair_ishPair->begin();
     auto it_tagJetPair_j0bdt = tagJetPair_j0bdt->begin();
     auto it_tagJetPair_j1bdt = tagJetPair_j1bdt->begin();
     auto it_tagJetPair_hascsvj0 = tagJetPair_hascsvj0->begin();
     auto it_tagJetPair_hastophj = tagJetPair_hastophj->begin();
     auto it_tagJetPair_id = tagJetPair_id->begin();
     auto it_tagJetPair_pt = tagJetPair_pt->begin();
     auto it_tagJetPair_mass = tagJetPair_mass->begin();
     auto it_tagJetPair_eta = tagJetPair_eta->begin();
     auto it_tagJetPair_phi = tagJetPair_phi->begin();
     auto it_tagJetPair_energy = tagJetPair_energy->begin();
     auto it_tagJetPair_dr = tagJetPair_dr->begin();
     auto it_tagJetPair_deta = tagJetPair_deta->begin();
     auto it_tagJetPair_dphi = tagJetPair_dphi->begin();
     auto it_tagJetPair_ismaxBDT = tagJetPair_ismaxBDT->begin();
     auto it_tagJetPair_higestbdt = tagJetPair_higestbdt->begin();
     auto it_tagJetPair_sumcsv = tagJetPair_sumcsv->begin();
     auto it_tagJetPair_sumbdt = tagJetPair_sumbdt->begin();
     auto it_tagJetPair_sumqg = tagJetPair_sumqg->begin();
     auto it_tagJetPair_ptratio = tagJetPair_ptratio->begin();
     auto it_tagJetPair_WChi2 = tagJetPair_WChi2->begin();
     auto it_tagJetPair_minlepdr = tagJetPair_minlepdr->begin();
     auto it_tagJetPair_minlepdeta = tagJetPair_minlepdeta->begin();
     auto it_tagJetPair_minlepdphi = tagJetPair_minlepdphi->begin();
     auto it_tagJetPair_minlepmass = tagJetPair_minlepmass->begin();
     auto it_tagJetPair_minlepptratio = tagJetPair_minlepptratio->begin();
     auto it_tagJetPair_maxlepdr = tagJetPair_maxlepdr->begin();
     auto it_tagJetPair_maxlepdeta = tagJetPair_maxlepdeta->begin();
     auto it_tagJetPair_maxlepdphi = tagJetPair_maxlepdphi->begin();
     auto it_tagJetPair_maxlepmass = tagJetPair_maxlepmass->begin();
     auto it_tagJetPair_maxlepptratio = tagJetPair_maxlepptratio->begin();
     auto it_tagJetPair_minjdr = tagJetPair_minjdr->begin();
     auto it_tagJetPair_minjdeta = tagJetPair_minjdeta->begin();
     auto it_tagJetPair_minjdphi = tagJetPair_minjdphi->begin();
     auto it_tagJetPair_minjmass = tagJetPair_minjmass->begin();
     auto it_tagJetPair_minjptratio = tagJetPair_minjptratio->begin();
     auto it_tagJetPair_maxjdr = tagJetPair_maxjdr->begin();
     auto it_tagJetPair_maxjdeta = tagJetPair_maxjdeta->begin();
     auto it_tagJetPair_maxjdphi = tagJetPair_maxjdphi->begin();
     auto it_tagJetPair_maxjmass = tagJetPair_maxjmass->begin();
     auto it_tagJetPair_maxjptratio = tagJetPair_maxjptratio->begin();
     auto it_tagJetPair_remaincsvj0dr = tagJetPair_remaincsvj0dr->begin();
     auto it_tagJetPair_remaincsvj0deta = tagJetPair_remaincsvj0deta->begin();
     auto it_tagJetPair_remaincsvj0dphi = tagJetPair_remaincsvj0dphi->begin();
     auto it_tagJetPair_remaincsvj0mass = tagJetPair_remaincsvj0mass->begin();
     auto it_tagJetPair_remaincsvj0ptratio = tagJetPair_remaincsvj0ptratio->begin();
     auto it_tagJetPair_remaincsvj1dr = tagJetPair_remaincsvj1dr->begin();
     auto it_tagJetPair_remaincsvj1deta = tagJetPair_remaincsvj1deta->begin();
     auto it_tagJetPair_remaincsvj1dphi = tagJetPair_remaincsvj1dphi->begin();
     auto it_tagJetPair_remaincsvj1mass = tagJetPair_remaincsvj1mass->begin();
     auto it_tagJetPair_remaincsvj1ptratio = tagJetPair_remaincsvj1ptratio->begin();
     auto it_tagJetPair_minjOvermaxjdr = tagJetPair_minjOvermaxjdr->begin();
     auto it_tagJetPair_jTopminChi2 = tagJetPair_jTopminChi2->begin();
     auto it_tagJetPair_TopminChi2jpt = tagJetPair_TopminChi2jpt->begin();
     auto it_tagJetPair_minlepishlep = tagJetPair_minlepishlep->begin();
     auto it_tagJetPair_minleppt = tagJetPair_minleppt->begin();
     auto it_tagJetPair_minlepeta = tagJetPair_minlepeta->begin();
     auto it_tagJetPair_minlepphi = tagJetPair_minlepphi->begin();
     auto it_tagJetPair_minlepenergy = tagJetPair_minlepenergy->begin();
     auto it_tagJetPair_minlepmotherIndex = tagJetPair_minlepmotherIndex->begin();
     auto it_tagJetPair_minlepmotherId = tagJetPair_minlepmotherId->begin();
     auto it_tagJetPair_minlvpt = tagJetPair_minlvpt->begin();
     auto it_tagJetPair_minlveta = tagJetPair_minlveta->begin();
     auto it_tagJetPair_minlvphi = tagJetPair_minlvphi->begin();
     auto it_tagJetPair_minlvenergy = tagJetPair_minlvenergy->begin();
     auto it_tagJetPair_minlvmotherIndex = tagJetPair_minlvmotherIndex->begin();
     auto it_tagJetPair_minlvmotherId = tagJetPair_minlvmotherId->begin();
     auto it_tagJetPair_maxlepishlep = tagJetPair_maxlepishlep->begin();
     auto it_tagJetPair_maxleppt = tagJetPair_maxleppt->begin();
     auto it_tagJetPair_maxlepeta = tagJetPair_maxlepeta->begin();
     auto it_tagJetPair_maxlepphi = tagJetPair_maxlepphi->begin();
     auto it_tagJetPair_maxlepenergy = tagJetPair_maxlepenergy->begin();
     auto it_tagJetPair_maxlepmotherIndex = tagJetPair_maxlepmotherIndex->begin();
     auto it_tagJetPair_maxlepmotherId = tagJetPair_maxlepmotherId->begin();
     auto it_tagJetPair_maxlvpt = tagJetPair_maxlvpt->begin();
     auto it_tagJetPair_maxlveta = tagJetPair_maxlveta->begin();
     auto it_tagJetPair_maxlvphi = tagJetPair_maxlvphi->begin();
     auto it_tagJetPair_maxlvenergy = tagJetPair_maxlvenergy->begin();
     auto it_tagJetPair_maxlvmotherIndex = tagJetPair_maxlvmotherIndex->begin();
     auto it_tagJetPair_maxlvmotherId = tagJetPair_maxlvmotherId->begin();
     if(pair_bdt>pair_currbdt){
      tagJetPair_BDT->insert(it,pair_bdt);
      tagJetPair_ishPair->insert(it_tagJetPair_ishPair+index,bdtJetPair_ishPair->at(pair_en));
      tagJetPair_j0bdt->insert(it_tagJetPair_j0bdt+index,bdtJetPair_j0bdt->at(pair_en));
      tagJetPair_j1bdt->insert(it_tagJetPair_j1bdt+index,bdtJetPair_j1bdt->at(pair_en));
      tagJetPair_hascsvj0->insert(it_tagJetPair_hascsvj0+index,bdtJetPair_hascsvj0->at(pair_en));
      tagJetPair_hastophj->insert(it_tagJetPair_hastophj+index,bdtJetPair_hastophj->at(pair_en));
      tagJetPair_id->insert(it_tagJetPair_id+index,bdtJetPair_id->at(pair_en));
      tagJetPair_pt->insert(it_tagJetPair_pt+index,bdtJetPair_pt->at(pair_en));
      tagJetPair_mass->insert(it_tagJetPair_mass+index,bdtJetPair_mass->at(pair_en));
      tagJetPair_eta->insert(it_tagJetPair_eta+index,bdtJetPair_eta->at(pair_en));
      tagJetPair_phi->insert(it_tagJetPair_phi+index,bdtJetPair_phi->at(pair_en));
      tagJetPair_energy->insert(it_tagJetPair_energy+index,bdtJetPair_energy->at(pair_en));
      tagJetPair_dr->insert(it_tagJetPair_dr+index,bdtJetPair_dr->at(pair_en));
      tagJetPair_deta->insert(it_tagJetPair_deta+index,bdtJetPair_deta->at(pair_en));
      tagJetPair_dphi->insert(it_tagJetPair_dphi+index,bdtJetPair_dphi->at(pair_en));
      tagJetPair_ismaxBDT->insert(it_tagJetPair_ismaxBDT+index,bdtJetPair_ismaxBDT->at(pair_en));
      tagJetPair_higestbdt->insert(it_tagJetPair_higestbdt+index,bdtJetPair_higestbdt->at(pair_en));
      tagJetPair_sumcsv->insert(it_tagJetPair_sumcsv+index,bdtJetPair_sumcsv->at(pair_en));
      tagJetPair_sumbdt->insert(it_tagJetPair_sumbdt+index,bdtJetPair_sumbdt->at(pair_en));
      tagJetPair_sumqg->insert(it_tagJetPair_sumqg+index,bdtJetPair_sumqg->at(pair_en));
      tagJetPair_ptratio->insert(it_tagJetPair_ptratio+index,bdtJetPair_ptratio->at(pair_en));
      tagJetPair_WChi2->insert(it_tagJetPair_WChi2+index,bdtJetPair_WChi2->at(pair_en));
      tagJetPair_minlepdr->insert(it_tagJetPair_minlepdr+index,bdtJetPair_minlepdr->at(pair_en));
      tagJetPair_minlepdeta->insert(it_tagJetPair_minlepdeta+index,bdtJetPair_minlepdeta->at(pair_en));
      tagJetPair_minlepdphi->insert(it_tagJetPair_minlepdphi+index,bdtJetPair_minlepdphi->at(pair_en));
      tagJetPair_minlepmass->insert(it_tagJetPair_minlepmass+index,bdtJetPair_minlepmass->at(pair_en));
      tagJetPair_minlepptratio->insert(it_tagJetPair_minlepptratio+index,bdtJetPair_minlepptratio->at(pair_en));
      tagJetPair_maxlepdr->insert(it_tagJetPair_maxlepdr+index,bdtJetPair_maxlepdr->at(pair_en));
      tagJetPair_maxlepdeta->insert(it_tagJetPair_maxlepdeta+index,bdtJetPair_maxlepdeta->at(pair_en));
      tagJetPair_maxlepdphi->insert(it_tagJetPair_maxlepdphi+index,bdtJetPair_maxlepdphi->at(pair_en));
      tagJetPair_maxlepmass->insert(it_tagJetPair_maxlepmass+index,bdtJetPair_maxlepmass->at(pair_en));
      tagJetPair_maxlepptratio->insert(it_tagJetPair_maxlepptratio+index,bdtJetPair_maxlepptratio->at(pair_en));
      tagJetPair_minjdr->insert(it_tagJetPair_minjdr+index,bdtJetPair_minjdr->at(pair_en));
      tagJetPair_minjdeta->insert(it_tagJetPair_minjdeta+index,bdtJetPair_minjdeta->at(pair_en));
      tagJetPair_minjdphi->insert(it_tagJetPair_minjdphi+index,bdtJetPair_minjdphi->at(pair_en));
      tagJetPair_minjmass->insert(it_tagJetPair_minjmass+index,bdtJetPair_minjmass->at(pair_en));
      tagJetPair_minjptratio->insert(it_tagJetPair_minjptratio+index,bdtJetPair_minjptratio->at(pair_en));
      tagJetPair_maxjdr->insert(it_tagJetPair_maxjdr+index,bdtJetPair_maxjdr->at(pair_en));
      tagJetPair_maxjdeta->insert(it_tagJetPair_maxjdeta+index,bdtJetPair_maxjdeta->at(pair_en));
      tagJetPair_maxjdphi->insert(it_tagJetPair_maxjdphi+index,bdtJetPair_maxjdphi->at(pair_en));
      tagJetPair_maxjmass->insert(it_tagJetPair_maxjmass+index,bdtJetPair_maxjmass->at(pair_en));
      tagJetPair_maxjptratio->insert(it_tagJetPair_maxjptratio+index,bdtJetPair_maxjptratio->at(pair_en));
      tagJetPair_remaincsvj0dr->insert(it_tagJetPair_remaincsvj0dr+index,bdtJetPair_remaincsvj0dr->at(pair_en));
      tagJetPair_remaincsvj0deta->insert(it_tagJetPair_remaincsvj0deta+index,bdtJetPair_remaincsvj0deta->at(pair_en));
      tagJetPair_remaincsvj0dphi->insert(it_tagJetPair_remaincsvj0dphi+index,bdtJetPair_remaincsvj0dphi->at(pair_en));
      tagJetPair_remaincsvj0mass->insert(it_tagJetPair_remaincsvj0mass+index,bdtJetPair_remaincsvj0mass->at(pair_en));
      tagJetPair_remaincsvj0ptratio->insert(it_tagJetPair_remaincsvj0ptratio+index,bdtJetPair_remaincsvj0ptratio->at(pair_en));
      tagJetPair_remaincsvj1dr->insert(it_tagJetPair_remaincsvj1dr+index,bdtJetPair_remaincsvj1dr->at(pair_en));
      tagJetPair_remaincsvj1deta->insert(it_tagJetPair_remaincsvj1deta+index,bdtJetPair_remaincsvj1deta->at(pair_en));
      tagJetPair_remaincsvj1dphi->insert(it_tagJetPair_remaincsvj1dphi+index,bdtJetPair_remaincsvj1dphi->at(pair_en));
      tagJetPair_remaincsvj1mass->insert(it_tagJetPair_remaincsvj1mass+index,bdtJetPair_remaincsvj1mass->at(pair_en));
      tagJetPair_remaincsvj1ptratio->insert(it_tagJetPair_remaincsvj1ptratio+index,bdtJetPair_remaincsvj1ptratio->at(pair_en));
      tagJetPair_minjOvermaxjdr->insert(it_tagJetPair_minjOvermaxjdr+index,bdtJetPair_minjOvermaxjdr->at(pair_en));
      tagJetPair_jTopminChi2->insert(it_tagJetPair_jTopminChi2+index,bdtJetPair_jTopminChi2->at(pair_en));
      tagJetPair_TopminChi2jpt->insert(it_tagJetPair_TopminChi2jpt+index,bdtJetPair_TopminChi2jpt->at(pair_en));
      tagJetPair_minlepishlep->insert(it_tagJetPair_minlepishlep+index,bdtJetPair_minlepishlep->at(pair_en));
      tagJetPair_minleppt->insert(it_tagJetPair_minleppt+index,bdtJetPair_minleppt->at(pair_en));
      tagJetPair_minlepeta->insert(it_tagJetPair_minlepeta+index,bdtJetPair_minlepeta->at(pair_en));
      tagJetPair_minlepphi->insert(it_tagJetPair_minlepphi+index,bdtJetPair_minlepphi->at(pair_en));
      tagJetPair_minlepenergy->insert(it_tagJetPair_minlepenergy+index,bdtJetPair_minlepenergy->at(pair_en));
      tagJetPair_minlepmotherIndex->insert(it_tagJetPair_minlepmotherIndex+index,bdtJetPair_minlepmotherIndex->at(pair_en));
      tagJetPair_minlepmotherId->insert(it_tagJetPair_minlepmotherId+index,bdtJetPair_minlepmotherId->at(pair_en));
      tagJetPair_minlvpt->insert(it_tagJetPair_minlvpt+index,bdtJetPair_minlvpt->at(pair_en));
      tagJetPair_minlveta->insert(it_tagJetPair_minlveta+index,bdtJetPair_minlveta->at(pair_en));
      tagJetPair_minlvphi->insert(it_tagJetPair_minlvphi+index,bdtJetPair_minlvphi->at(pair_en));
      tagJetPair_minlvenergy->insert(it_tagJetPair_minlvenergy+index,bdtJetPair_minlvenergy->at(pair_en));
      tagJetPair_minlvmotherIndex->insert(it_tagJetPair_minlvmotherIndex+index,bdtJetPair_minlvmotherIndex->at(pair_en));
      tagJetPair_minlvmotherId->insert(it_tagJetPair_minlvmotherId+index,bdtJetPair_minlvmotherId->at(pair_en));
      tagJetPair_maxlepishlep->insert(it_tagJetPair_maxlepishlep+index,bdtJetPair_maxlepishlep->at(pair_en));
      tagJetPair_maxleppt->insert(it_tagJetPair_maxleppt+index,bdtJetPair_maxleppt->at(pair_en));
      tagJetPair_maxlepeta->insert(it_tagJetPair_maxlepeta+index,bdtJetPair_maxlepeta->at(pair_en));
      tagJetPair_maxlepphi->insert(it_tagJetPair_maxlepphi+index,bdtJetPair_maxlepphi->at(pair_en));
      tagJetPair_maxlepenergy->insert(it_tagJetPair_maxlepenergy+index,bdtJetPair_maxlepenergy->at(pair_en));
      tagJetPair_maxlepmotherIndex->insert(it_tagJetPair_maxlepmotherIndex+index,bdtJetPair_maxlepmotherIndex->at(pair_en));
      tagJetPair_maxlepmotherId->insert(it_tagJetPair_maxlepmotherId+index,bdtJetPair_maxlepmotherId->at(pair_en));
      tagJetPair_maxlvpt->insert(it_tagJetPair_maxlvpt+index,bdtJetPair_maxlvpt->at(pair_en));
      tagJetPair_maxlveta->insert(it_tagJetPair_maxlveta+index,bdtJetPair_maxlveta->at(pair_en));
      tagJetPair_maxlvphi->insert(it_tagJetPair_maxlvphi+index,bdtJetPair_maxlvphi->at(pair_en));
      tagJetPair_maxlvenergy->insert(it_tagJetPair_maxlvenergy+index,bdtJetPair_maxlvenergy->at(pair_en));
      tagJetPair_maxlvmotherIndex->insert(it_tagJetPair_maxlvmotherIndex+index,bdtJetPair_maxlvmotherIndex->at(pair_en));
      tagJetPair_maxlvmotherId->insert(it_tagJetPair_maxlvmotherId+index,bdtJetPair_maxlvmotherId->at(pair_en));
      inserted = true;
      break;
     }
     index++;
    }
    if(!inserted){
     tagJetPair_BDT->push_back(pair_bdt);
     tagJetPair_ishPair->push_back(bdtJetPair_ishPair->at(pair_en));
     tagJetPair_j0bdt->push_back(bdtJetPair_j0bdt->at(pair_en));
     tagJetPair_j1bdt->push_back(bdtJetPair_j1bdt->at(pair_en));
     tagJetPair_hascsvj0->push_back(bdtJetPair_hascsvj0->at(pair_en));
     tagJetPair_hastophj->push_back(bdtJetPair_hastophj->at(pair_en));
     tagJetPair_id->push_back(bdtJetPair_id->at(pair_en));
     tagJetPair_pt->push_back(bdtJetPair_pt->at(pair_en));
     tagJetPair_mass->push_back(bdtJetPair_mass->at(pair_en));
     tagJetPair_eta->push_back(bdtJetPair_eta->at(pair_en));
     tagJetPair_phi->push_back(bdtJetPair_phi->at(pair_en));
     tagJetPair_energy->push_back(bdtJetPair_energy->at(pair_en));
     tagJetPair_dr->push_back(bdtJetPair_dr->at(pair_en));
     tagJetPair_deta->push_back(bdtJetPair_deta->at(pair_en));
     tagJetPair_dphi->push_back(bdtJetPair_dphi->at(pair_en));
     tagJetPair_ismaxBDT->push_back(bdtJetPair_ismaxBDT->at(pair_en));
     tagJetPair_higestbdt->push_back(bdtJetPair_higestbdt->at(pair_en));
     tagJetPair_sumcsv->push_back(bdtJetPair_sumcsv->at(pair_en));
     tagJetPair_sumbdt->push_back(bdtJetPair_sumbdt->at(pair_en));
     tagJetPair_sumqg->push_back(bdtJetPair_sumqg->at(pair_en));
     tagJetPair_ptratio->push_back(bdtJetPair_ptratio->at(pair_en));
     tagJetPair_WChi2->push_back(bdtJetPair_WChi2->at(pair_en));
     tagJetPair_minlepdr->push_back(bdtJetPair_minlepdr->at(pair_en));
     tagJetPair_minlepdeta->push_back(bdtJetPair_minlepdeta->at(pair_en));
     tagJetPair_minlepdphi->push_back(bdtJetPair_minlepdphi->at(pair_en));
     tagJetPair_minlepmass->push_back(bdtJetPair_minlepmass->at(pair_en));
     tagJetPair_minlepptratio->push_back(bdtJetPair_minlepptratio->at(pair_en));
     tagJetPair_maxlepdr->push_back(bdtJetPair_maxlepdr->at(pair_en));
     tagJetPair_maxlepdeta->push_back(bdtJetPair_maxlepdeta->at(pair_en));
     tagJetPair_maxlepdphi->push_back(bdtJetPair_maxlepdphi->at(pair_en));
     tagJetPair_maxlepmass->push_back(bdtJetPair_maxlepmass->at(pair_en));
     tagJetPair_maxlepptratio->push_back(bdtJetPair_maxlepptratio->at(pair_en));
     tagJetPair_minjdr->push_back(bdtJetPair_minjdr->at(pair_en));
     tagJetPair_minjdeta->push_back(bdtJetPair_minjdeta->at(pair_en));
     tagJetPair_minjdphi->push_back(bdtJetPair_minjdphi->at(pair_en));
     tagJetPair_minjmass->push_back(bdtJetPair_minjmass->at(pair_en));
     tagJetPair_minjptratio->push_back(bdtJetPair_minjptratio->at(pair_en));
     tagJetPair_maxjdr->push_back(bdtJetPair_maxjdr->at(pair_en));
     tagJetPair_maxjdeta->push_back(bdtJetPair_maxjdeta->at(pair_en));
     tagJetPair_maxjdphi->push_back(bdtJetPair_maxjdphi->at(pair_en));
     tagJetPair_maxjmass->push_back(bdtJetPair_maxjmass->at(pair_en));
     tagJetPair_maxjptratio->push_back(bdtJetPair_maxjptratio->at(pair_en));
     tagJetPair_remaincsvj0dr->push_back(bdtJetPair_remaincsvj0dr->at(pair_en));
     tagJetPair_remaincsvj0deta->push_back(bdtJetPair_remaincsvj0deta->at(pair_en));
     tagJetPair_remaincsvj0dphi->push_back(bdtJetPair_remaincsvj0dphi->at(pair_en));
     tagJetPair_remaincsvj0mass->push_back(bdtJetPair_remaincsvj0mass->at(pair_en));
     tagJetPair_remaincsvj0ptratio->push_back(bdtJetPair_remaincsvj0ptratio->at(pair_en));
     tagJetPair_remaincsvj1dr->push_back(bdtJetPair_remaincsvj1dr->at(pair_en));
     tagJetPair_remaincsvj1deta->push_back(bdtJetPair_remaincsvj1deta->at(pair_en));
     tagJetPair_remaincsvj1dphi->push_back(bdtJetPair_remaincsvj1dphi->at(pair_en));
     tagJetPair_remaincsvj1mass->push_back(bdtJetPair_remaincsvj1mass->at(pair_en));
     tagJetPair_remaincsvj1ptratio->push_back(bdtJetPair_remaincsvj1ptratio->at(pair_en));
     tagJetPair_minjOvermaxjdr->push_back(bdtJetPair_minjOvermaxjdr->at(pair_en));
     tagJetPair_jTopminChi2->push_back(bdtJetPair_jTopminChi2->at(pair_en));
     tagJetPair_TopminChi2jpt->push_back(bdtJetPair_TopminChi2jpt->at(pair_en));
     tagJetPair_minlepishlep->push_back(bdtJetPair_minlepishlep->at(pair_en));
     tagJetPair_minleppt->push_back(bdtJetPair_minleppt->at(pair_en));
     tagJetPair_minlepeta->push_back(bdtJetPair_minlepeta->at(pair_en));
     tagJetPair_minlepphi->push_back(bdtJetPair_minlepphi->at(pair_en));
     tagJetPair_minlepenergy->push_back(bdtJetPair_minlepenergy->at(pair_en));
     tagJetPair_minlepmotherIndex->push_back(bdtJetPair_minlepmotherIndex->at(pair_en));
     tagJetPair_minlepmotherId->push_back(bdtJetPair_minlepmotherId->at(pair_en));
     tagJetPair_minlvpt->push_back(bdtJetPair_minlvpt->at(pair_en));
     tagJetPair_minlveta->push_back(bdtJetPair_minlveta->at(pair_en));
     tagJetPair_minlvphi->push_back(bdtJetPair_minlvphi->at(pair_en));
     tagJetPair_minlvenergy->push_back(bdtJetPair_minlvenergy->at(pair_en));
     tagJetPair_minlvmotherIndex->push_back(bdtJetPair_minlvmotherIndex->at(pair_en));
     tagJetPair_minlvmotherId->push_back(bdtJetPair_minlvmotherId->at(pair_en));
     tagJetPair_maxlepishlep->push_back(bdtJetPair_maxlepishlep->at(pair_en));
     tagJetPair_maxleppt->push_back(bdtJetPair_maxleppt->at(pair_en));
     tagJetPair_maxlepeta->push_back(bdtJetPair_maxlepeta->at(pair_en));
     tagJetPair_maxlepphi->push_back(bdtJetPair_maxlepphi->at(pair_en));
     tagJetPair_maxlepenergy->push_back(bdtJetPair_maxlepenergy->at(pair_en));
     tagJetPair_maxlepmotherIndex->push_back(bdtJetPair_maxlepmotherIndex->at(pair_en));
     tagJetPair_maxlepmotherId->push_back(bdtJetPair_maxlepmotherId->at(pair_en));
     tagJetPair_maxlvpt->push_back(bdtJetPair_maxlvpt->at(pair_en));
     tagJetPair_maxlveta->push_back(bdtJetPair_maxlveta->at(pair_en));
     tagJetPair_maxlvphi->push_back(bdtJetPair_maxlvphi->at(pair_en));
     tagJetPair_maxlvenergy->push_back(bdtJetPair_maxlvenergy->at(pair_en));
     tagJetPair_maxlvmotherIndex->push_back(bdtJetPair_maxlvmotherIndex->at(pair_en));
     tagJetPair_maxlvmotherId->push_back(bdtJetPair_maxlvmotherId->at(pair_en));
    }
   }
  }
 }
}
//Fill Branches
void rSetBranchAddress(TTree* readingtree){
 readingtree->SetBranchAddress("EVENT_event",&rEVENT_event,&b_rEVENT_event);
 readingtree->SetBranchAddress("EVENT_genWeight",&rEVENT_genWeight,&b_rEVENT_genWeight);
 readingtree->SetBranchAddress("num_Jet_matchLooseHJet",&rnum_Jet_matchLooseHJet,&b_rnum_Jet_matchLooseHJet);
 readingtree->SetBranchAddress("num_Jet_matchMediumHJet",&rnum_Jet_matchMediumHJet,&b_rnum_Jet_matchMediumHJet);
 readingtree->SetBranchAddress("num_Jet_matchTightHJet",&rnum_Jet_matchTightHJet,&b_rnum_Jet_matchTightHJet);
 readingtree->SetBranchAddress("num_ishlep",&rnum_ishlep,&b_rnum_ishlep);
 readingtree->SetBranchAddress("num_Gen_Leph",&rnum_Gen_Leph,&b_rnum_Gen_Leph);
 readingtree->SetBranchAddress("num_Gen_Jeth",&rnum_Gen_Jeth,&b_rnum_Gen_Jeth);
 readingtree->SetBranchAddress("num_Gen_Leptop",&rnum_Gen_Leptop,&b_rnum_Gen_Leptop);
 readingtree->SetBranchAddress("num_Gen_Lvh",&rnum_Gen_Lvh,&b_rnum_Gen_Lvh);
 readingtree->SetBranchAddress("num_Gen_Lvtop",&rnum_Gen_Lvtop,&b_rnum_Gen_Lvtop);
 readingtree->SetBranchAddress("Met_type1PF_pt",&rMet_type1PF_pt,&b_rMet_type1PF_pt);
 readingtree->SetBranchAddress("Met_type1PF_px",&rMet_type1PF_px,&b_rMet_type1PF_px);
 readingtree->SetBranchAddress("Met_type1PF_py",&rMet_type1PF_py,&b_rMet_type1PF_py);
 readingtree->SetBranchAddress("Met_type1PF_pz",&rMet_type1PF_pz,&b_rMet_type1PF_pz);
 readingtree->SetBranchAddress("Met_type1PF_phi",&rMet_type1PF_phi,&b_rMet_type1PF_phi);
 readingtree->SetBranchAddress("Gen_type1PF_Met",&rGen_type1PF_Met,&b_rGen_type1PF_Met);
 readingtree->SetBranchAddress("FakeLep_pt",&rFakeLep_pt,&b_rFakeLep_pt);
 readingtree->SetBranchAddress("FakeLep_eta",&rFakeLep_eta,&b_rFakeLep_eta);
 readingtree->SetBranchAddress("FakeLep_phi",&rFakeLep_phi,&b_rFakeLep_phi);
 readingtree->SetBranchAddress("FakeLep_energy",&rFakeLep_energy,&b_rFakeLep_energy);
 readingtree->SetBranchAddress("csvJet_isMediumHJet",&rcsvJet_isMediumHJet,&b_rcsvJet_isMediumHJet);
 readingtree->SetBranchAddress("csvJet_partonFlavour",&rcsvJet_partonFlavour,&b_rcsvJet_partonFlavour);
 readingtree->SetBranchAddress("csvJet_pt",&rcsvJet_pt,&b_rcsvJet_pt);
 readingtree->SetBranchAddress("csvJet_eta",&rcsvJet_eta,&b_rcsvJet_eta);
 readingtree->SetBranchAddress("csvJet_phi",&rcsvJet_phi,&b_rcsvJet_phi);
 readingtree->SetBranchAddress("csvJet_energy",&rcsvJet_energy,&b_rcsvJet_energy);
 readingtree->SetBranchAddress("Jet_numLoose",&rJet_numLoose,&b_rJet_numLoose);
 readingtree->SetBranchAddress("Jet_lepdrmin",&rJet_lepdrmin,&b_rJet_lepdrmin);
 readingtree->SetBranchAddress("Jet_pt",&rJet_pt,&b_rJet_pt);
 readingtree->SetBranchAddress("Jet_eta",&rJet_eta,&b_rJet_eta);
 readingtree->SetBranchAddress("Jet_phi",&rJet_phi,&b_rJet_phi);
 readingtree->SetBranchAddress("Jet_energy",&rJet_energy,&b_rJet_energy);
 readingtree->SetBranchAddress("Jet_partonFlavour",&rJet_partonFlavour,&b_rJet_partonFlavour);
 readingtree->SetBranchAddress("Jet_px",&rJet_px,&b_rJet_px);
 readingtree->SetBranchAddress("Jet_py",&rJet_py,&b_rJet_py);
 readingtree->SetBranchAddress("Jet_pz",&rJet_pz,&b_rJet_pz);
 readingtree->SetBranchAddress("Jet_mass",&rJet_mass,&b_rJet_mass);
 readingtree->SetBranchAddress("Jet_newpfCombinedInclusiveSecondaryVertexV2BJetTags",&rJet_newpfCombinedInclusiveSecondaryVertexV2BJetTags,&b_rJet_newpfCombinedInclusiveSecondaryVertexV2BJetTags);
 readingtree->SetBranchAddress("Jet_pfCombinedInclusiveSecondaryVertexV2BJetTags",&rJet_pfCombinedInclusiveSecondaryVertexV2BJetTags,&b_rJet_pfCombinedInclusiveSecondaryVertexV2BJetTags);
 readingtree->SetBranchAddress("Jet_isLooseHJet",&rJet_isLooseHJet,&b_rJet_isLooseHJet);
 readingtree->SetBranchAddress("Jet_isMediumHJet",&rJet_isMediumHJet,&b_rJet_isMediumHJet);
 readingtree->SetBranchAddress("Jet_isTightHJet",&rJet_isTightHJet,&b_rJet_isTightHJet);
 readingtree->SetBranchAddress("Jet_dRGenJeth",&rJet_dRGenJeth,&b_rJet_dRGenJeth);
 readingtree->SetBranchAddress("Jet_pfCombinedMVAV2BJetTags",&rJet_pfCombinedMVAV2BJetTags,&b_rJet_pfCombinedMVAV2BJetTags);
 readingtree->SetBranchAddress("Jet_pfJetProbabilityBJetTags",&rJet_pfJetProbabilityBJetTags,&b_rJet_pfJetProbabilityBJetTags);
 readingtree->SetBranchAddress("Jet_pileupId",&rJet_pileupId,&b_rJet_pileupId);
 readingtree->SetBranchAddress("Jet_neutralHadEnergyFraction",&rJet_neutralHadEnergyFraction,&b_rJet_neutralHadEnergyFraction);
 readingtree->SetBranchAddress("Jet_neutralEmEnergyFraction",&rJet_neutralEmEnergyFraction,&b_rJet_neutralEmEnergyFraction);
 readingtree->SetBranchAddress("Jet_chargedHadronEnergyFraction",&rJet_chargedHadronEnergyFraction,&b_rJet_chargedHadronEnergyFraction);
 readingtree->SetBranchAddress("Jet_chargedEmEnergyFraction",&rJet_chargedEmEnergyFraction,&b_rJet_chargedEmEnergyFraction);
 readingtree->SetBranchAddress("Jet_muonEnergyFraction",&rJet_muonEnergyFraction,&b_rJet_muonEnergyFraction);
 readingtree->SetBranchAddress("Jet_electronEnergy",&rJet_electronEnergy,&b_rJet_electronEnergy);
 readingtree->SetBranchAddress("Jet_photonEnergy",&rJet_photonEnergy,&b_rJet_photonEnergy);
 readingtree->SetBranchAddress("Jet_emEnergyFraction",&rJet_emEnergyFraction,&b_rJet_emEnergyFraction);
 readingtree->SetBranchAddress("Jet_numberOfConstituents",&rJet_numberOfConstituents,&b_rJet_numberOfConstituents);
 readingtree->SetBranchAddress("Jet_chargedMultiplicity",&rJet_chargedMultiplicity,&b_rJet_chargedMultiplicity);
 readingtree->SetBranchAddress("Jet_vtxMass",&rJet_vtxMass,&b_rJet_vtxMass);
 readingtree->SetBranchAddress("Jet_vtxNtracks",&rJet_vtxNtracks,&b_rJet_vtxNtracks);
 readingtree->SetBranchAddress("Jet_vtx3DVal",&rJet_vtx3DVal,&b_rJet_vtx3DVal);
 readingtree->SetBranchAddress("Jet_vtx3DSig",&rJet_vtx3DSig,&b_rJet_vtx3DSig);
 readingtree->SetBranchAddress("Jet_ishighestcsv",&rJet_ishighestcsv,&b_rJet_ishighestcsv);
 readingtree->SetBranchAddress("Jet_istophJet",&rJet_istophJet,&b_rJet_istophJet);
 readingtree->SetBranchAddress("Jet_metptratio",&rJet_metptratio,&b_rJet_metptratio);
 readingtree->SetBranchAddress("Jet_dilepmetptratio",&rJet_dilepmetptratio,&b_rJet_dilepmetptratio);
 readingtree->SetBranchAddress("Jet_nonjdr",&rJet_nonjdr,&b_rJet_nonjdr);
 readingtree->SetBranchAddress("Jet_nonjdilepdr",&rJet_nonjdilepdr,&b_rJet_nonjdilepdr);
 readingtree->SetBranchAddress("Jet_lepdrmax",&rJet_lepdrmax,&b_rJet_lepdrmax);
 readingtree->SetBranchAddress("Jet_dilepdr",&rJet_dilepdr,&b_rJet_dilepdr);
 readingtree->SetBranchAddress("Jet_bjdr",&rJet_bjdr,&b_rJet_bjdr);
 readingtree->SetBranchAddress("Jet_nonjdeta",&rJet_nonjdeta,&b_rJet_nonjdeta);
 readingtree->SetBranchAddress("Jet_nonjdilepdeta",&rJet_nonjdilepdeta,&b_rJet_nonjdilepdeta);
 readingtree->SetBranchAddress("Jet_lepdetamin",&rJet_lepdetamin,&b_rJet_lepdetamin);
 readingtree->SetBranchAddress("Jet_lepdetamax",&rJet_lepdetamax,&b_rJet_lepdetamax);
 readingtree->SetBranchAddress("Jet_dilepdeta",&rJet_dilepdeta,&b_rJet_dilepdeta);
 readingtree->SetBranchAddress("Jet_bjdeta",&rJet_bjdeta,&b_rJet_bjdeta);
 readingtree->SetBranchAddress("Jet_nonjdphi",&rJet_nonjdphi,&b_rJet_nonjdphi);
 readingtree->SetBranchAddress("Jet_nonjdilepdphi",&rJet_nonjdilepdphi,&b_rJet_nonjdilepdphi);
 readingtree->SetBranchAddress("Jet_lepdphimin",&rJet_lepdphimin,&b_rJet_lepdphimin);
 readingtree->SetBranchAddress("Jet_lepdphimax",&rJet_lepdphimax,&b_rJet_lepdphimax);
 readingtree->SetBranchAddress("Jet_dilepdphi",&rJet_dilepdphi,&b_rJet_dilepdphi);
 readingtree->SetBranchAddress("Jet_bjdphi",&rJet_bjdphi,&b_rJet_bjdphi);
 readingtree->SetBranchAddress("Jet_nonjptratio",&rJet_nonjptratio,&b_rJet_nonjptratio);
 readingtree->SetBranchAddress("Jet_nonjdilepptratio",&rJet_nonjdilepptratio,&b_rJet_nonjdilepptratio);
 readingtree->SetBranchAddress("Jet_lepptratiomin",&rJet_lepptratiomin,&b_rJet_lepptratiomin);
 readingtree->SetBranchAddress("Jet_lepptratiomax",&rJet_lepptratiomax,&b_rJet_lepptratiomax);
 readingtree->SetBranchAddress("Jet_dilepptratio",&rJet_dilepptratio,&b_rJet_dilepptratio);
 readingtree->SetBranchAddress("Jet_bjptratio",&rJet_bjptratio,&b_rJet_bjptratio);
 readingtree->SetBranchAddress("Jet_qg",&rJet_qg,&b_rJet_qg);
 readingtree->SetBranchAddress("Jet_axis2",&rJet_axis2,&b_rJet_axis2);
 readingtree->SetBranchAddress("Jet_ptD",&rJet_ptD,&b_rJet_ptD);
 readingtree->SetBranchAddress("Jet_mult",&rJet_mult,&b_rJet_mult);
 readingtree->SetBranchAddress("FakeLep_ishlep",&rFakeLep_ishlep,&b_rFakeLep_ishlep);
 readingtree->SetBranchAddress("FakeLep_ptoverlep",&rFakeLep_ptoverlep,&b_rFakeLep_ptoverlep);
 readingtree->SetBranchAddress("FakeLep_ptovermetlep",&rFakeLep_ptovermetlep,&b_rFakeLep_ptovermetlep);
 readingtree->SetBranchAddress("FakeLep_rlepdrjet0csv",&rFakeLep_rlepdrjet0csv,&b_rFakeLep_rlepdrjet0csv);
 readingtree->SetBranchAddress("FakeLep_rlepdrjet0mass",&rFakeLep_rlepdrjet0mass,&b_rFakeLep_rlepdrjet0mass);
 readingtree->SetBranchAddress("FakeLep_rlepdrjet0mt",&rFakeLep_rlepdrjet0mt,&b_rFakeLep_rlepdrjet0mt);
 readingtree->SetBranchAddress("FakeLep_rlepdrjet1mass",&rFakeLep_rlepdrjet1mass,&b_rFakeLep_rlepdrjet1mass);
 readingtree->SetBranchAddress("FakeLep_sumjetsdphi",&rFakeLep_sumjetsdphi,&b_rFakeLep_sumjetsdphi);
 readingtree->SetBranchAddress("FakeLep_3toncsvjetsdphi",&rFakeLep_3toncsvjetsdphi,&b_rFakeLep_3toncsvjetsdphi);
 readingtree->SetBranchAddress("FakeLep_csvjet2dr",&rFakeLep_csvjet2dr,&b_rFakeLep_csvjet2dr);
 readingtree->SetBranchAddress("FakeLep_csvjet3dr",&rFakeLep_csvjet3dr,&b_rFakeLep_csvjet3dr);
 readingtree->SetBranchAddress("FakeLep_metdphi",&rFakeLep_metdphi,&b_rFakeLep_metdphi);
 readingtree->SetBranchAddress("FakeLep_metlepdphi",&rFakeLep_metlepdphi,&b_rFakeLep_metlepdphi);
 readingtree->SetBranchAddress("FakeLep_minjetdr",&rFakeLep_minjetdr,&b_rFakeLep_minjetdr);
 readingtree->SetBranchAddress("FakeLep_mt",&rFakeLep_mt,&b_rFakeLep_mt);
 readingtree->SetBranchAddress("FakeLep_ptovermet",&rFakeLep_ptovermet,&b_rFakeLep_ptovermet);
 readingtree->SetBranchAddress("FakeLep_rlepdrjet1mt",&rFakeLep_rlepdrjet1mt,&b_rFakeLep_rlepdrjet1mt);
 readingtree->SetBranchAddress("FakeLep_sumjetsdr",&rFakeLep_sumjetsdr,&b_rFakeLep_sumjetsdr);
 readingtree->SetBranchAddress("FakeLep_3toncsvjetsdr",&rFakeLep_3toncsvjetsdr,&b_rFakeLep_3toncsvjetsdr);
 readingtree->SetBranchAddress("FakeLep_csvjet0mass",&rFakeLep_csvjet0mass,&b_rFakeLep_csvjet0mass);
 readingtree->SetBranchAddress("FakeLep_csvjet1mass",&rFakeLep_csvjet1mass,&b_rFakeLep_csvjet1mass);
 readingtree->SetBranchAddress("FakeLep_csvjet1mt",&rFakeLep_csvjet1mt,&b_rFakeLep_csvjet1mt);
 readingtree->SetBranchAddress("FakeLep_csvjet2deta",&rFakeLep_csvjet2deta,&b_rFakeLep_csvjet2deta);
 readingtree->SetBranchAddress("FakeLep_csvjet2dphi",&rFakeLep_csvjet2dphi,&b_rFakeLep_csvjet2dphi);
 readingtree->SetBranchAddress("FakeLep_csvjet3deta",&rFakeLep_csvjet3deta,&b_rFakeLep_csvjet3deta);
 readingtree->SetBranchAddress("FakeLep_csvjet3dphi",&rFakeLep_csvjet3dphi,&b_rFakeLep_csvjet3dphi);
 readingtree->SetBranchAddress("FakeLep_metmt",&rFakeLep_metmt,&b_rFakeLep_metmt);
 readingtree->SetBranchAddress("FakeLep_minjetdphi",&rFakeLep_minjetdphi,&b_rFakeLep_minjetdphi);
 readingtree->SetBranchAddress("H_Gen_pt",&rH_Gen_pt,&b_rH_Gen_pt);
 readingtree->SetBranchAddress("H_Gen_eta",&rH_Gen_eta,&b_rH_Gen_eta);
 readingtree->SetBranchAddress("H_Gen_phi",&rH_Gen_phi,&b_rH_Gen_phi);
 readingtree->SetBranchAddress("H_Gen_energy",&rH_Gen_energy,&b_rH_Gen_energy);
 readingtree->SetBranchAddress("Jeth_Gen_pt",&rJeth_Gen_pt,&b_rJeth_Gen_pt);
 readingtree->SetBranchAddress("Jeth_Gen_eta",&rJeth_Gen_eta,&b_rJeth_Gen_eta);
 readingtree->SetBranchAddress("Jeth_Gen_phi",&rJeth_Gen_phi,&b_rJeth_Gen_phi);
 readingtree->SetBranchAddress("Jeth_Gen_energy",&rJeth_Gen_energy,&b_rJeth_Gen_energy);
 readingtree->SetBranchAddress("Leph_Gen_pt",&rLeph_Gen_pt,&b_rLeph_Gen_pt);
 readingtree->SetBranchAddress("Leph_Gen_eta",&rLeph_Gen_eta,&b_rLeph_Gen_eta);
 readingtree->SetBranchAddress("Leph_Gen_phi",&rLeph_Gen_phi,&b_rLeph_Gen_phi);
 readingtree->SetBranchAddress("Leph_Gen_energy",&rLeph_Gen_energy,&b_rLeph_Gen_energy);
 readingtree->SetBranchAddress("Leph_Gen_Id",&rLeph_Gen_Id,&b_rLeph_Gen_Id);
 readingtree->SetBranchAddress("Lvh_Gen_pt",&rLvh_Gen_pt,&b_rLvh_Gen_pt);
 readingtree->SetBranchAddress("Lvh_Gen_eta",&rLvh_Gen_eta,&b_rLvh_Gen_eta);
 readingtree->SetBranchAddress("Lvh_Gen_phi",&rLvh_Gen_phi,&b_rLvh_Gen_phi);
 readingtree->SetBranchAddress("Lvh_Gen_energy",&rLvh_Gen_energy,&b_rLvh_Gen_energy);
 readingtree->SetBranchAddress("Lvh_Gen_Id",&rLvh_Gen_Id,&b_rLvh_Gen_Id);
 readingtree->SetBranchAddress("Lvtop_Gen_pt",&rLvtop_Gen_pt,&b_rLvtop_Gen_pt);
 readingtree->SetBranchAddress("Lvtop_Gen_eta",&rLvtop_Gen_eta,&b_rLvtop_Gen_eta);
 readingtree->SetBranchAddress("Lvtop_Gen_phi",&rLvtop_Gen_phi,&b_rLvtop_Gen_phi);
 readingtree->SetBranchAddress("Lvtop_Gen_energy",&rLvtop_Gen_energy,&b_rLvtop_Gen_energy);
 readingtree->SetBranchAddress("Lvtop_Gen_Id",&rLvtop_Gen_Id,&b_rLvtop_Gen_Id);
 readingtree->SetBranchAddress("Gen_pdg_id",&rGen_pdg_id,&b_rGen_pdg_id);
 readingtree->SetBranchAddress("Gen_pt",&rGen_pt,&b_rGen_pt);
 readingtree->SetBranchAddress("Gen_eta",&rGen_eta,&b_rGen_eta);
 readingtree->SetBranchAddress("Gen_phi",&rGen_phi,&b_rGen_phi);
 readingtree->SetBranchAddress("Gen_energy",&rGen_energy,&b_rGen_energy);
 readingtree->SetBranchAddress("Gen_motherpdg_id",&rGen_motherpdg_id,&b_rGen_motherpdg_id);
 readingtree->SetBranchAddress("Gen_BmotherIndex",&rGen_BmotherIndex,&b_rGen_BmotherIndex);
 readingtree->SetBranchAddress("Gen_numMother",&rGen_numMother,&b_rGen_numMother);
};
void wSetBranchAddress(TTree* newtree){
 newtree->Branch("EVENT_event",&EVENT_event);
 newtree->Branch("EVENT_genWeight",&EVENT_genWeight);
 newtree->Branch("EVENT_xsecWeight",&EVENT_xsecWeight);
 newtree->Branch("num_Jet_matchLooseHJet",&num_Jet_matchLooseHJet);
 newtree->Branch("num_Jet_matchMediumHJet",&num_Jet_matchMediumHJet);
 newtree->Branch("num_Jet_matchTightHJet",&num_Jet_matchTightHJet);
 newtree->Branch("Jet_numLoose",&Jet_numLoose);
 newtree->Branch("num_ishlep",&num_ishlep);
 newtree->Branch("num_ishPair",&num_ishPair);
 newtree->Branch("num_Gen_Leph",&num_Gen_Leph);
 newtree->Branch("num_Gen_Jeth",&num_Gen_Jeth);
 newtree->Branch("num_Gen_Leptop",&num_Gen_Leptop);
 newtree->Branch("num_Gen_Lvh",&num_Gen_Lvh);
 newtree->Branch("num_Gen_Lvtop",&num_Gen_Lvtop);
 newtree->Branch("Met_type1PF_pt",&Met_type1PF_pt);
 newtree->Branch("Met_type1PF_px",&Met_type1PF_px);
 newtree->Branch("Met_type1PF_py",&Met_type1PF_py);
 newtree->Branch("Met_type1PF_pz",&Met_type1PF_pz);
 newtree->Branch("Met_type1PF_phi",&Met_type1PF_phi);
 newtree->Branch("Gen_type1PF_Met",&Gen_type1PF_Met);
 newtree->Branch("Gen_pdg_id",&Gen_pdg_id);
 newtree->Branch("Gen_pt",&Gen_pt);
 newtree->Branch("Gen_eta",&Gen_eta);
 newtree->Branch("Gen_phi",&Gen_phi);
 newtree->Branch("Gen_energy",&Gen_energy);
 newtree->Branch("Gen_motherpdg_id",&Gen_motherpdg_id);
 newtree->Branch("Gen_BmotherIndex",&Gen_BmotherIndex);
 newtree->Branch("Gen_numMother",&Gen_numMother);
 newtree->Branch("FakeLep_pt",&FakeLep_pt);
 newtree->Branch("FakeLep_eta",&FakeLep_eta);
 newtree->Branch("FakeLep_phi",&FakeLep_phi);
 newtree->Branch("FakeLep_energy",&FakeLep_energy);
 newtree->Branch("csvJet_isMediumHJet",&csvJet_isMediumHJet);
 newtree->Branch("csvJet_partonFlavour",&csvJet_partonFlavour);
 newtree->Branch("csvJet_pt",&csvJet_pt);
 newtree->Branch("csvJet_eta",&csvJet_eta);
 newtree->Branch("csvJet_phi",&csvJet_phi);
 newtree->Branch("csvJet_energy",&csvJet_energy);
 newtree->Branch("Jet_lepdrmin",&Jet_lepdrmin);
 newtree->Branch("Jet_pt",&Jet_pt);
 newtree->Branch("Jet_eta",&Jet_eta);
 newtree->Branch("Jet_phi",&Jet_phi);
 newtree->Branch("Jet_energy",&Jet_energy);
 newtree->Branch("Jet_partonFlavour",&Jet_partonFlavour);
 newtree->Branch("Jet_px",&Jet_px);
 newtree->Branch("Jet_py",&Jet_py);
 newtree->Branch("Jet_pz",&Jet_pz);
 newtree->Branch("Jet_mass",&Jet_mass);
 newtree->Branch("Jet_qg",&Jet_qg);
 newtree->Branch("Jet_axis2",&Jet_axis2);
 newtree->Branch("Jet_ptD",&Jet_ptD);
 newtree->Branch("Jet_mult",&Jet_mult);
 newtree->Branch("Jet_newpfCombinedInclusiveSecondaryVertexV2BJetTags",&Jet_newpfCombinedInclusiveSecondaryVertexV2BJetTags);
 newtree->Branch("Jet_pfCombinedInclusiveSecondaryVertexV2BJetTags",&Jet_pfCombinedInclusiveSecondaryVertexV2BJetTags);
 newtree->Branch("Jet_isLooseHJet",&Jet_isLooseHJet);
 newtree->Branch("Jet_isMediumHJet",&Jet_isMediumHJet);
 newtree->Branch("Jet_isTightHJet",&Jet_isTightHJet);
 newtree->Branch("Jet_dRGenJeth",&Jet_dRGenJeth);
 newtree->Branch("Jet_pfCombinedMVAV2BJetTags",&Jet_pfCombinedMVAV2BJetTags);
 newtree->Branch("Jet_pfJetProbabilityBJetTags",&Jet_pfJetProbabilityBJetTags);
 newtree->Branch("Jet_pileupId",&Jet_pileupId);
 newtree->Branch("Jet_neutralHadEnergyFraction",&Jet_neutralHadEnergyFraction);
 newtree->Branch("Jet_neutralEmEnergyFraction",&Jet_neutralEmEnergyFraction);
 newtree->Branch("Jet_chargedHadronEnergyFraction",&Jet_chargedHadronEnergyFraction);
 newtree->Branch("Jet_chargedEmEnergyFraction",&Jet_chargedEmEnergyFraction);
 newtree->Branch("Jet_muonEnergyFraction",&Jet_muonEnergyFraction);
 newtree->Branch("Jet_electronEnergy",&Jet_electronEnergy);
 newtree->Branch("Jet_photonEnergy",&Jet_photonEnergy);
 newtree->Branch("Jet_emEnergyFraction",&Jet_emEnergyFraction);
 newtree->Branch("Jet_numberOfConstituents",&Jet_numberOfConstituents);
 newtree->Branch("Jet_chargedMultiplicity",&Jet_chargedMultiplicity);
 newtree->Branch("Jet_vtxMass",&Jet_vtxMass);
 newtree->Branch("Jet_vtxNtracks",&Jet_vtxNtracks);
 newtree->Branch("Jet_vtx3DVal",&Jet_vtx3DVal);
 newtree->Branch("Jet_vtx3DSig",&Jet_vtx3DSig);
 newtree->Branch("Jet_ishighestcsv",&Jet_ishighestcsv);
 newtree->Branch("Jet_istophJet",&Jet_istophJet);
 newtree->Branch("Jet_metptratio",&Jet_metptratio);
 newtree->Branch("Jet_dilepmetptratio",&Jet_dilepmetptratio);
 newtree->Branch("Jet_nonjdr",&Jet_nonjdr);
 newtree->Branch("Jet_nonjdilepdr",&Jet_nonjdilepdr);
 newtree->Branch("Jet_lepdrmax",&Jet_lepdrmax);
 newtree->Branch("Jet_dilepdr",&Jet_dilepdr);
 newtree->Branch("Jet_bjdr",&Jet_bjdr);
 newtree->Branch("Jet_nonjdeta",&Jet_nonjdeta);
 newtree->Branch("Jet_nonjdilepdeta",&Jet_nonjdilepdeta);
 newtree->Branch("Jet_lepdetamin",&Jet_lepdetamin);
 newtree->Branch("Jet_lepdetamax",&Jet_lepdetamax);
 newtree->Branch("Jet_dilepdeta",&Jet_dilepdeta);
 newtree->Branch("Jet_bjdeta",&Jet_bjdeta);
 newtree->Branch("Jet_nonjdphi",&Jet_nonjdphi);
 newtree->Branch("Jet_nonjdilepdphi",&Jet_nonjdilepdphi);
 newtree->Branch("Jet_lepdphimin",&Jet_lepdphimin);
 newtree->Branch("Jet_lepdphimax",&Jet_lepdphimax);
 newtree->Branch("Jet_dilepdphi",&Jet_dilepdphi);
 newtree->Branch("Jet_bjdphi",&Jet_bjdphi);
 newtree->Branch("Jet_nonjptratio",&Jet_nonjptratio);
 newtree->Branch("Jet_nonjdilepptratio",&Jet_nonjdilepptratio);
 newtree->Branch("Jet_lepptratiomin",&Jet_lepptratiomin);
 newtree->Branch("Jet_lepptratiomax",&Jet_lepptratiomax);
 newtree->Branch("Jet_dilepptratio",&Jet_dilepptratio);
 newtree->Branch("Jet_bjptratio",&Jet_bjptratio);
 newtree->Branch("Jet_BDT",&Jet_BDT);
 newtree->Branch("bdtJet_BDT",&bdtJet_BDT);
 newtree->Branch("bdtJet_ishighestcsv",&bdtJet_ishighestcsv);
 newtree->Branch("bdtJet_istophJet",&bdtJet_istophJet);
 newtree->Branch("bdtJet_isLooseHJet",&bdtJet_isLooseHJet);
 newtree->Branch("bdtJet_isMediumHJet",&bdtJet_isMediumHJet);
 newtree->Branch("bdtJet_isTightHJet",&bdtJet_isTightHJet);
 newtree->Branch("bdtJet_pt",&bdtJet_pt);
 newtree->Branch("bdtJet_eta",&bdtJet_eta);
 newtree->Branch("bdtJet_phi",&bdtJet_phi);
 newtree->Branch("bdtJet_energy",&bdtJet_energy);
 newtree->Branch("bdtJet_qg",&bdtJet_qg);
 newtree->Branch("bdtJet_newpfCombinedInclusiveSecondaryVertexV2BJetTags",&bdtJet_newpfCombinedInclusiveSecondaryVertexV2BJetTags);
 newtree->Branch("bdtJet_lepdrmin",&bdtJet_lepdrmin);
 newtree->Branch("bdtJet_pfCombinedMVAV2BJetTags",&bdtJet_pfCombinedMVAV2BJetTags);
 newtree->Branch("bdtJet_lepdrmax",&bdtJet_lepdrmax);
 newtree->Branch("FakeLep_ishlep",&FakeLep_ishlep);
 newtree->Branch("FakeLep_ptoverlep",&FakeLep_ptoverlep);
 newtree->Branch("FakeLep_ptovermetlep",&FakeLep_ptovermetlep);
 newtree->Branch("FakeLep_rlepdrjet0csv",&FakeLep_rlepdrjet0csv);
 newtree->Branch("FakeLep_rlepdrjet0mass",&FakeLep_rlepdrjet0mass);
 newtree->Branch("FakeLep_rlepdrjet0mt",&FakeLep_rlepdrjet0mt);
 newtree->Branch("FakeLep_rlepdrjet1mass",&FakeLep_rlepdrjet1mass);
 newtree->Branch("FakeLep_sumjetsdphi",&FakeLep_sumjetsdphi);
 newtree->Branch("FakeLep_3toncsvjetsdphi",&FakeLep_3toncsvjetsdphi);
 newtree->Branch("FakeLep_csvjet2dr",&FakeLep_csvjet2dr);
 newtree->Branch("FakeLep_csvjet3dr",&FakeLep_csvjet3dr);
 newtree->Branch("FakeLep_metdphi",&FakeLep_metdphi);
 newtree->Branch("FakeLep_metlepdphi",&FakeLep_metlepdphi);
 newtree->Branch("FakeLep_minjetdr",&FakeLep_minjetdr);
 newtree->Branch("FakeLep_mt",&FakeLep_mt);
 newtree->Branch("FakeLep_ptovermet",&FakeLep_ptovermet);
 newtree->Branch("FakeLep_rlepdrjet1mt",&FakeLep_rlepdrjet1mt);
 newtree->Branch("FakeLep_sumjetsdr",&FakeLep_sumjetsdr);
 newtree->Branch("FakeLep_3toncsvjetsdr",&FakeLep_3toncsvjetsdr);
 newtree->Branch("FakeLep_csvjet0mass",&FakeLep_csvjet0mass);
 newtree->Branch("FakeLep_csvjet1mass",&FakeLep_csvjet1mass);
 newtree->Branch("FakeLep_csvjet1mt",&FakeLep_csvjet1mt);
 newtree->Branch("FakeLep_csvjet2deta",&FakeLep_csvjet2deta);
 newtree->Branch("FakeLep_csvjet2dphi",&FakeLep_csvjet2dphi);
 newtree->Branch("FakeLep_csvjet3deta",&FakeLep_csvjet3deta);
 newtree->Branch("FakeLep_csvjet3dphi",&FakeLep_csvjet3dphi);
 newtree->Branch("FakeLep_metmt",&FakeLep_metmt);
 newtree->Branch("FakeLep_minjetdphi",&FakeLep_minjetdphi);
 //LepTag
 newtree->Branch("FakeLep_bdt",&FakeLep_bdt);
 newtree->Branch("FakeLep_ishigherbdt",&FakeLep_ishigherbdt);
 //JetPair
 newtree->Branch("bdtJetPair_id",&bdtJetPair_id);
 newtree->Branch("bdtJetPair_pt",&bdtJetPair_pt);
 newtree->Branch("bdtJetPair_eta",&bdtJetPair_eta);
 newtree->Branch("bdtJetPair_phi",&bdtJetPair_phi);
 newtree->Branch("bdtJetPair_energy",&bdtJetPair_energy);
 newtree->Branch("bdtJetPair_ishPair",&bdtJetPair_ishPair);
 newtree->Branch("bdtJetPair_dr",&bdtJetPair_dr);
 newtree->Branch("bdtJetPair_deta",&bdtJetPair_deta);
 newtree->Branch("bdtJetPair_dphi",&bdtJetPair_dphi);
 newtree->Branch("bdtJetPair_mass",&bdtJetPair_mass);
 newtree->Branch("bdtJetPair_higestbdt",&bdtJetPair_higestbdt);
 newtree->Branch("bdtJetPair_sumcsv",&bdtJetPair_sumcsv);
 newtree->Branch("bdtJetPair_sumbdt",&bdtJetPair_sumbdt);
 newtree->Branch("bdtJetPair_sumqg",&bdtJetPair_sumqg);
 newtree->Branch("bdtJetPair_ptratio",&bdtJetPair_ptratio);
 newtree->Branch("bdtJetPair_WChi2",&bdtJetPair_WChi2);
 newtree->Branch("bdtJetPair_minlepdr",&bdtJetPair_minlepdr);
 newtree->Branch("bdtJetPair_minlepdeta",&bdtJetPair_minlepdeta);
 newtree->Branch("bdtJetPair_minlepdphi",&bdtJetPair_minlepdphi);
 newtree->Branch("bdtJetPair_minlepmass",&bdtJetPair_minlepmass);
 newtree->Branch("bdtJetPair_minlepptratio",&bdtJetPair_minlepptratio);
 newtree->Branch("bdtJetPair_maxlepdr",&bdtJetPair_maxlepdr);
 newtree->Branch("bdtJetPair_maxlepdeta",&bdtJetPair_maxlepdeta);
 newtree->Branch("bdtJetPair_maxlepdphi",&bdtJetPair_maxlepdphi);
 newtree->Branch("bdtJetPair_maxlepmass",&bdtJetPair_maxlepmass);
 newtree->Branch("bdtJetPair_maxlepptratio",&bdtJetPair_maxlepptratio);
 newtree->Branch("bdtJetPair_minjdr",&bdtJetPair_minjdr);
 newtree->Branch("bdtJetPair_minjdeta",&bdtJetPair_minjdeta);
 newtree->Branch("bdtJetPair_minjdphi",&bdtJetPair_minjdphi);
 newtree->Branch("bdtJetPair_minjmass",&bdtJetPair_minjmass);
 newtree->Branch("bdtJetPair_minjptratio",&bdtJetPair_minjptratio);
 newtree->Branch("bdtJetPair_maxjdr",&bdtJetPair_maxjdr);
 newtree->Branch("bdtJetPair_maxjdeta",&bdtJetPair_maxjdeta);
 newtree->Branch("bdtJetPair_maxjdphi",&bdtJetPair_maxjdphi);
 newtree->Branch("bdtJetPair_maxjmass",&bdtJetPair_maxjmass);
 newtree->Branch("bdtJetPair_maxjptratio",&bdtJetPair_maxjptratio);
 newtree->Branch("bdtJetPair_remaincsvj0dr",&bdtJetPair_remaincsvj0dr);
 newtree->Branch("bdtJetPair_remaincsvj0deta",&bdtJetPair_remaincsvj0deta);
 newtree->Branch("bdtJetPair_remaincsvj0dphi",&bdtJetPair_remaincsvj0dphi);
 newtree->Branch("bdtJetPair_remaincsvj0mass",&bdtJetPair_remaincsvj0mass);
 newtree->Branch("bdtJetPair_remaincsvj0ptratio",&bdtJetPair_remaincsvj0ptratio);
 newtree->Branch("bdtJetPair_remaincsvj1dr",&bdtJetPair_remaincsvj1dr);
 newtree->Branch("bdtJetPair_remaincsvj1deta",&bdtJetPair_remaincsvj1deta);
 newtree->Branch("bdtJetPair_remaincsvj1dphi",&bdtJetPair_remaincsvj1dphi);
 newtree->Branch("bdtJetPair_remaincsvj1mass",&bdtJetPair_remaincsvj1mass);
 newtree->Branch("bdtJetPair_remaincsvj1ptratio",&bdtJetPair_remaincsvj1ptratio);
 newtree->Branch("bdtJetPair_minjOvermaxjdr",&bdtJetPair_minjOvermaxjdr);
 newtree->Branch("bdtJetPair_jTopminChi2",&bdtJetPair_jTopminChi2);
 newtree->Branch("bdtJetPair_TopminChi2jpt",&bdtJetPair_TopminChi2jpt);
 newtree->Branch("bdtJetPair_hascsvj0",&bdtJetPair_hascsvj0);
 newtree->Branch("bdtJetPair_hastophj",&bdtJetPair_hastophj);
 newtree->Branch("bdtJetPair_BDT",&bdtJetPair_BDT);
 newtree->Branch("bdtJetPair_ismaxBDT",&bdtJetPair_ismaxBDT);
 newtree->Branch("bdtJetPair_minlepishlep",&bdtJetPair_minlepishlep);
 newtree->Branch("bdtJetPair_minleppt",&bdtJetPair_minleppt);
 newtree->Branch("bdtJetPair_minlepeta",&bdtJetPair_minlepeta);
 newtree->Branch("bdtJetPair_minlepphi",&bdtJetPair_minlepphi);
 newtree->Branch("bdtJetPair_minlepenergy",&bdtJetPair_minlepenergy);
 newtree->Branch("bdtJetPair_minlepmotherIndex",&bdtJetPair_minlepmotherIndex);
 newtree->Branch("bdtJetPair_minlepmotherId",&bdtJetPair_minlepmotherId);
 newtree->Branch("bdtJetPair_minlvpt",&bdtJetPair_minlvpt);
 newtree->Branch("bdtJetPair_minlveta",&bdtJetPair_minlveta);
 newtree->Branch("bdtJetPair_minlvphi",&bdtJetPair_minlvphi);
 newtree->Branch("bdtJetPair_minlvenergy",&bdtJetPair_minlvenergy);
 newtree->Branch("bdtJetPair_minlvmotherIndex",&bdtJetPair_minlvmotherIndex);
 newtree->Branch("bdtJetPair_minlvmotherId",&bdtJetPair_minlvmotherId);
 newtree->Branch("bdtJetPair_maxlepishlep",&bdtJetPair_maxlepishlep);
 newtree->Branch("bdtJetPair_maxleppt",&bdtJetPair_maxleppt);
 newtree->Branch("bdtJetPair_maxlepeta",&bdtJetPair_maxlepeta);
 newtree->Branch("bdtJetPair_maxlepphi",&bdtJetPair_maxlepphi);
 newtree->Branch("bdtJetPair_maxlepenergy",&bdtJetPair_maxlepenergy);
 newtree->Branch("bdtJetPair_maxlepmotherIndex",&bdtJetPair_maxlepmotherIndex);
 newtree->Branch("bdtJetPair_maxlepmotherId",&bdtJetPair_maxlepmotherId);
 newtree->Branch("bdtJetPair_maxlvpt",&bdtJetPair_maxlvpt);
 newtree->Branch("bdtJetPair_maxlveta",&bdtJetPair_maxlveta);
 newtree->Branch("bdtJetPair_maxlvphi",&bdtJetPair_maxlvphi);
 newtree->Branch("bdtJetPair_maxlvenergy",&bdtJetPair_maxlvenergy);
 newtree->Branch("bdtJetPair_maxlvmotherIndex",&bdtJetPair_maxlvmotherIndex);
 newtree->Branch("bdtJetPair_maxlvmotherId",&bdtJetPair_maxlvmotherId);
 newtree->Branch("bdtJetPair_j0bdt",&bdtJetPair_j0bdt);
 newtree->Branch("bdtJetPair_j1bdt",&bdtJetPair_j1bdt);
 newtree->Branch("tagJetPair_j0bdt",&tagJetPair_j0bdt);
 newtree->Branch("tagJetPair_j1bdt",&tagJetPair_j1bdt);
 newtree->Branch("tagJetPair_ishPair",&tagJetPair_ishPair);
 newtree->Branch("tagJetPair_hascsvj0",&tagJetPair_hascsvj0);
 newtree->Branch("tagJetPair_hastophj",&tagJetPair_hastophj);
 newtree->Branch("tagJetPair_id",&tagJetPair_id);
 newtree->Branch("tagJetPair_BDT",&tagJetPair_BDT);
 newtree->Branch("tagJetPair_pt",&tagJetPair_pt);
 newtree->Branch("tagJetPair_mass",&tagJetPair_mass);
 newtree->Branch("tagJetPair_eta",&tagJetPair_eta);
 newtree->Branch("tagJetPair_phi",&tagJetPair_phi);
 newtree->Branch("tagJetPair_energy",&tagJetPair_energy);
 newtree->Branch("tagJetPair_dr",&tagJetPair_dr);
 newtree->Branch("tagJetPair_deta",&tagJetPair_deta);
 newtree->Branch("tagJetPair_dphi",&tagJetPair_dphi);
 newtree->Branch("tagJetPair_ismaxBDT",&tagJetPair_ismaxBDT);
 newtree->Branch("tagJetPair_higestbdt",&tagJetPair_higestbdt);
 newtree->Branch("tagJetPair_sumcsv",&tagJetPair_sumcsv);
 newtree->Branch("tagJetPair_sumbdt",&tagJetPair_sumbdt);
 newtree->Branch("tagJetPair_sumqg",&tagJetPair_sumqg);
 newtree->Branch("tagJetPair_ptratio",&tagJetPair_ptratio);
 newtree->Branch("tagJetPair_WChi2",&tagJetPair_WChi2);
 newtree->Branch("tagJetPair_minlepdr",&tagJetPair_minlepdr);
 newtree->Branch("tagJetPair_minlepdeta",&tagJetPair_minlepdeta);
 newtree->Branch("tagJetPair_minlepdphi",&tagJetPair_minlepdphi);
 newtree->Branch("tagJetPair_minlepmass",&tagJetPair_minlepmass);
 newtree->Branch("tagJetPair_minlepptratio",&tagJetPair_minlepptratio);
 newtree->Branch("tagJetPair_maxlepdr",&tagJetPair_maxlepdr);
 newtree->Branch("tagJetPair_maxlepdeta",&tagJetPair_maxlepdeta);
 newtree->Branch("tagJetPair_maxlepdphi",&tagJetPair_maxlepdphi);
 newtree->Branch("tagJetPair_maxlepmass",&tagJetPair_maxlepmass);
 newtree->Branch("tagJetPair_maxlepptratio",&tagJetPair_maxlepptratio);
 newtree->Branch("tagJetPair_minjdr",&tagJetPair_minjdr);
 newtree->Branch("tagJetPair_minjdeta",&tagJetPair_minjdeta);
 newtree->Branch("tagJetPair_minjdphi",&tagJetPair_minjdphi);
 newtree->Branch("tagJetPair_minjmass",&tagJetPair_minjmass);
 newtree->Branch("tagJetPair_minjptratio",&tagJetPair_minjptratio);
 newtree->Branch("tagJetPair_maxjdr",&tagJetPair_maxjdr);
 newtree->Branch("tagJetPair_maxjdeta",&tagJetPair_maxjdeta);
 newtree->Branch("tagJetPair_maxjdphi",&tagJetPair_maxjdphi);
 newtree->Branch("tagJetPair_maxjmass",&tagJetPair_maxjmass);
 newtree->Branch("tagJetPair_maxjptratio",&tagJetPair_maxjptratio);
 newtree->Branch("tagJetPair_remaincsvj0dr",&tagJetPair_remaincsvj0dr);
 newtree->Branch("tagJetPair_remaincsvj0deta",&tagJetPair_remaincsvj0deta);
 newtree->Branch("tagJetPair_remaincsvj0dphi",&tagJetPair_remaincsvj0dphi);
 newtree->Branch("tagJetPair_remaincsvj0mass",&tagJetPair_remaincsvj0mass);
 newtree->Branch("tagJetPair_remaincsvj0ptratio",&tagJetPair_remaincsvj0ptratio);
 newtree->Branch("tagJetPair_remaincsvj1dr",&tagJetPair_remaincsvj1dr);
 newtree->Branch("tagJetPair_remaincsvj1deta",&tagJetPair_remaincsvj1deta);
 newtree->Branch("tagJetPair_remaincsvj1dphi",&tagJetPair_remaincsvj1dphi);
 newtree->Branch("tagJetPair_remaincsvj1mass",&tagJetPair_remaincsvj1mass);
 newtree->Branch("tagJetPair_remaincsvj1ptratio",&tagJetPair_remaincsvj1ptratio);
 newtree->Branch("tagJetPair_minjOvermaxjdr",&tagJetPair_minjOvermaxjdr);
 newtree->Branch("tagJetPair_jTopminChi2",&tagJetPair_jTopminChi2);
 newtree->Branch("tagJetPair_TopminChi2jpt",&tagJetPair_TopminChi2jpt);
 newtree->Branch("tagJetPair_minlepishlep",&tagJetPair_minlepishlep);
 newtree->Branch("tagJetPair_minleppt",&tagJetPair_minleppt);
 newtree->Branch("tagJetPair_minlepeta",&tagJetPair_minlepeta);
 newtree->Branch("tagJetPair_minlepphi",&tagJetPair_minlepphi);
 newtree->Branch("tagJetPair_minlepenergy",&tagJetPair_minlepenergy);
 newtree->Branch("tagJetPair_minlepmotherIndex",&tagJetPair_minlepmotherIndex);
 newtree->Branch("tagJetPair_minlepmotherId",&tagJetPair_minlepmotherId);
 newtree->Branch("tagJetPair_minlvpt",&tagJetPair_minlvpt);
 newtree->Branch("tagJetPair_minlveta",&tagJetPair_minlveta);
 newtree->Branch("tagJetPair_minlvphi",&tagJetPair_minlvphi);
 newtree->Branch("tagJetPair_minlvenergy",&tagJetPair_minlvenergy);
 newtree->Branch("tagJetPair_minlvmotherIndex",&tagJetPair_minlvmotherIndex);
 newtree->Branch("tagJetPair_minlvmotherId",&tagJetPair_minlvmotherId);
 newtree->Branch("tagJetPair_maxlepishlep",&tagJetPair_maxlepishlep);
 newtree->Branch("tagJetPair_maxleppt",&tagJetPair_maxleppt);
 newtree->Branch("tagJetPair_maxlepeta",&tagJetPair_maxlepeta);
 newtree->Branch("tagJetPair_maxlepphi",&tagJetPair_maxlepphi);
 newtree->Branch("tagJetPair_maxlepenergy",&tagJetPair_maxlepenergy);
 newtree->Branch("tagJetPair_maxlepmotherIndex",&tagJetPair_maxlepmotherIndex);
 newtree->Branch("tagJetPair_maxlepmotherId",&tagJetPair_maxlepmotherId);
 newtree->Branch("tagJetPair_maxlvpt",&tagJetPair_maxlvpt);
 newtree->Branch("tagJetPair_maxlveta",&tagJetPair_maxlveta);
 newtree->Branch("tagJetPair_maxlvphi",&tagJetPair_maxlvphi);
 newtree->Branch("tagJetPair_maxlvenergy",&tagJetPair_maxlvenergy);
 newtree->Branch("tagJetPair_maxlvmotherIndex",&tagJetPair_maxlvmotherIndex);
 newtree->Branch("tagJetPair_maxlvmotherId",&tagJetPair_maxlvmotherId);
 //Regression
 newtree->Branch("H_Gen_massA",&H_Gen_massA);
 newtree->Branch("H_Gen_massB",&H_Gen_massB);
 newtree->Branch("H_Gen_massC",&H_Gen_massC);
 newtree->Branch("RegLep_px",&RegLep_px);
 newtree->Branch("RegLep_py",&RegLep_py);
 newtree->Branch("RegLep_pz",&RegLep_pz);
 newtree->Branch("RegLep_eta",&RegLep_eta);
 newtree->Branch("RegLep_energy",&RegLep_energy);
 newtree->Branch("RegJetPair_px",&RegJetPair_px);
 newtree->Branch("RegJetPair_py",&RegJetPair_py);
 newtree->Branch("RegJetPair_pz",&RegJetPair_pz);
 newtree->Branch("RegJetPair_eta",&RegJetPair_eta);
 newtree->Branch("RegJetPair_energy",&RegJetPair_energy);
 newtree->Branch("RegHsys_px",&RegHsys_px);
 newtree->Branch("RegHsys_pt",&RegHsys_pt);
 newtree->Branch("RegHsys_py",&RegHsys_py);
 newtree->Branch("RegHsys_pz",&RegHsys_pz);
 newtree->Branch("RegHsys_eta",&RegHsys_eta);
 newtree->Branch("RegHsys_energy",&RegHsys_energy);
 newtree->Branch("RegHsys_mass",&RegHsys_mass);
 newtree->Branch("RegMet",&RegMet);
 newtree->Branch("RegPt_LepOverMet",&RegPt_LepOverMet);
 newtree->Branch("RegPt_LepOverJetPair",&RegPt_LepOverJetPair);
 newtree->Branch("RegPt_MetOverJetPair",&RegPt_MetOverJetPair);
 newtree->Branch("RegdR_LepJetPair",&RegdR_LepJetPair);
 newtree->Branch("Regdeta_LepJetPair",&Regdeta_LepJetPair);
 newtree->Branch("Regdphi_LepJetPair",&Regdphi_LepJetPair);
 newtree->Branch("RegPt_Lep1OverMet",&RegPt_Lep1OverMet);
 newtree->Branch("RegPt_Lep2OverMet",&RegPt_Lep2OverMet);
 newtree->Branch("Regdphi_Lep1Met",&Regdphi_Lep1Met);
 newtree->Branch("Regdphi_Lep2Met",&Regdphi_Lep2Met);
 newtree->Branch("GenLep_px",&GenLep_px);
 newtree->Branch("GenLep_py",&GenLep_py);
 newtree->Branch("GenLep_pz",&GenLep_pz);
 newtree->Branch("GenLep_eta",&GenLep_eta);
 newtree->Branch("GenLep_energy",&GenLep_energy);
 newtree->Branch("GenJetPair_px",&GenJetPair_px);
 newtree->Branch("GenJetPair_py",&GenJetPair_py);
 newtree->Branch("GenJetPair_pz",&GenJetPair_pz);
 newtree->Branch("GenJetPair_eta",&GenJetPair_eta);
 newtree->Branch("GenJetPair_energy",&GenJetPair_energy);
 newtree->Branch("GenHsys_px",&GenHsys_px);
 newtree->Branch("GenHsys_py",&GenHsys_py);
 newtree->Branch("GenHsys_pz",&GenHsys_pz);
 newtree->Branch("GenHsys_eta",&GenHsys_eta);
 newtree->Branch("GenHsys_energy",&GenHsys_energy);
 newtree->Branch("GenHsys_mass",&GenHsys_mass);
 newtree->Branch("GenMet",&GenMet);
 newtree->Branch("GenPt_LepOverMet",&GenPt_LepOverMet);
 newtree->Branch("GenPt_LepOverJetPair",&GenPt_LepOverJetPair);
 newtree->Branch("GenPt_MetOverJetPair",&GenPt_MetOverJetPair);
 newtree->Branch("GendR_LepJetPair",&GendR_LepJetPair);
 newtree->Branch("Gendeta_LepJetPair",&Gendeta_LepJetPair);
 newtree->Branch("Gendphi_LepJetPair",&Gendphi_LepJetPair);
 newtree->Branch("TargetH_mass",&TargetH_mass);
 newtree->Branch("TargetH_pt",&TargetH_pt);
 newtree->Branch("TargetH_eta",&TargetH_eta);
 newtree->Branch("TargetH_energy",&TargetH_energy);
 newtree->Branch("minljjv_pt",&minljjv_pt);
 newtree->Branch("minljjv_eta",&minljjv_eta);
 newtree->Branch("minljjv_phi",&minljjv_phi);
 newtree->Branch("minljjv_energy",&minljjv_energy);
 newtree->Branch("minljjv_mass",&minljjv_mass);
 newtree->Branch("minljjv_ishpair",&minljjv_ishpair);
 newtree->Branch("minljjv_ishlep",&minljjv_ishlep);
 newtree->Branch("maxljjv_pt",&maxljjv_pt);
 newtree->Branch("maxljjv_eta",&maxljjv_eta);
 newtree->Branch("maxljjv_phi",&maxljjv_phi);
 newtree->Branch("maxljjv_energy",&maxljjv_energy);
 newtree->Branch("maxljjv_mass",&maxljjv_mass);
 newtree->Branch("maxljjv_ishpair",&maxljjv_ishpair);
 newtree->Branch("maxljjv_ishlep",&maxljjv_ishlep);
 newtree->Branch("genRegH_pt",&genRegH_pt);
 newtree->Branch("genRegH_eta",&genRegH_eta);
 newtree->Branch("genRegH_energy",&genRegH_energy);
 newtree->Branch("genRegH_mass",&genRegH_mass);
 newtree->Branch("maxRegH_pt",&maxRegH_pt);
 newtree->Branch("maxRegH_eta",&maxRegH_eta);
 newtree->Branch("maxRegH_energy",&maxRegH_energy);
 newtree->Branch("maxRegH_mass",&maxRegH_mass);
 newtree->Branch("minRegH_pt",&minRegH_pt);
 newtree->Branch("minRegH_eta",&minRegH_eta);
 newtree->Branch("minRegH_energy",&minRegH_energy);
 newtree->Branch("minRegH_mass",&minRegH_mass);
 newtree->Branch("minHsys_pt",&minHsys_pt);
 newtree->Branch("minHsys_eta",&minHsys_eta);
 newtree->Branch("minHsys_mass",&minHsys_mass);
 newtree->Branch("minHsys_energy",&minHsys_energy);
 newtree->Branch("minHsys_pz",&minHsys_pz);
 newtree->Branch("minHsys_px",&minHsys_px);
 newtree->Branch("minHsys_py",&minHsys_py);
 newtree->Branch("maxHsys_pt",&maxHsys_pt);
 newtree->Branch("maxHsys_eta",&maxHsys_eta);
 newtree->Branch("maxHsys_mass",&maxHsys_mass);
 newtree->Branch("maxHsys_energy",&maxHsys_energy);
 newtree->Branch("maxHsys_pz",&maxHsys_pz);
 newtree->Branch("maxHsys_px",&maxHsys_px);
 newtree->Branch("maxHsys_py",&maxHsys_py);
 newtree->Branch("minlep_pt",&minlep_pt);
 newtree->Branch("minlep_eta",&minlep_eta);
 newtree->Branch("minlep_phi",&minlep_phi);
 newtree->Branch("minlep_energy",&minlep_energy);
 newtree->Branch("minlep_ptratioMet",&minlep_ptratioMet);
 newtree->Branch("minlep_dphiMet",&minlep_dphiMet);
 newtree->Branch("maxlep_pt",&maxlep_pt);
 newtree->Branch("maxlep_eta",&maxlep_eta);
 newtree->Branch("maxlep_phi",&maxlep_phi);
 newtree->Branch("maxlep_energy",&maxlep_energy);
 newtree->Branch("maxlep_ptratioMet",&maxlep_ptratioMet);
 newtree->Branch("maxlep_dphiMet",&maxlep_dphiMet);
 //Train Regress Lv
 newtree->Branch("minlv_pt",&minlv_pt);
 newtree->Branch("minlv_eta",&minlv_eta);
 newtree->Branch("minlv_phi",&minlv_phi);
 newtree->Branch("minlv_energy",&minlv_energy);
 newtree->Branch("minReglv_pt",&minReglv_pt);
 newtree->Branch("minReglv_eta",&minReglv_eta);
 newtree->Branch("minReglv_phi",&minReglv_phi);
 newtree->Branch("minReglv_energy",&minReglv_energy);
 newtree->Branch("minljjReglv_mass",&minljjReglv_mass);
 newtree->Branch("Met_pt",&Met_pt);
 newtree->Branch("Met_phi",&Met_phi);
 newtree->Branch("jj_pt",&jj_pt);
 newtree->Branch("jj_eta",&jj_eta);
 newtree->Branch("jj_phi",&jj_phi);
 newtree->Branch("jj_energy",&jj_energy);
 newtree->Branch("jj_mass",&jj_mass);
 newtree->Branch("E_lXjj",&E_lXjj);
 newtree->Branch("Pt_lXjjXmet",&Pt_lXjjXmet);
 newtree->Branch("ljj_cosTheta",&ljj_cosTheta);
 newtree->Branch("MT_ljjMet",&MT_ljjMet);
 newtree->Branch("Meff_ljjMet",&Meff_ljjMet);
 newtree->Branch("Mtrue",&Mtrue);
 newtree->Branch("MTtot",&MTtot);
 newtree->Branch("MT_lMet",&MT_lMet);
 newtree->Branch("Mt_lMetOverM_jj",&Mt_lMetOverM_jj);
};
void wClearInitialization(){
 FakeLep_pt->clear();
 FakeLep_eta->clear();
 FakeLep_phi->clear();
 FakeLep_energy->clear();
 csvJet_isMediumHJet->clear();
 csvJet_partonFlavour->clear();
 csvJet_pt->clear();
 csvJet_eta->clear();
 csvJet_phi->clear();
 csvJet_energy->clear();
 Jet_lepdrmin->clear();
 Jet_pt->clear();
 Jet_eta->clear();
 Jet_phi->clear();
 Jet_energy->clear();
 Jet_partonFlavour->clear();
 Jet_px->clear();
 Jet_py->clear();
 Jet_pz->clear();
 Jet_mass->clear();
 Jet_qg->clear();
 Jet_axis2->clear();
 Jet_ptD->clear();
 Jet_mult->clear();
 Jet_newpfCombinedInclusiveSecondaryVertexV2BJetTags->clear();
 Jet_pfCombinedInclusiveSecondaryVertexV2BJetTags->clear();
 Jet_isLooseHJet->clear();
 Jet_isMediumHJet->clear();
 Jet_isTightHJet->clear();
 Jet_dRGenJeth->clear();
 Jet_pfCombinedMVAV2BJetTags->clear();
 Jet_pfJetProbabilityBJetTags->clear();
 Jet_pileupId->clear();
 Jet_neutralHadEnergyFraction->clear();
 Jet_neutralEmEnergyFraction->clear();
 Jet_chargedHadronEnergyFraction->clear();
 Jet_chargedEmEnergyFraction->clear();
 Jet_muonEnergyFraction->clear();
 Jet_electronEnergy->clear();
 Jet_photonEnergy->clear();
 Jet_emEnergyFraction->clear();
 Jet_numberOfConstituents->clear();
 Jet_chargedMultiplicity->clear();
 Jet_vtxMass->clear();
 Jet_vtxNtracks->clear();
 Jet_vtx3DVal->clear();
 Jet_vtx3DSig->clear();
 Jet_ishighestcsv->clear();
 Jet_istophJet->clear();
 Jet_metptratio->clear();
 Jet_dilepmetptratio->clear();
 Jet_nonjdr->clear();
 Jet_nonjdilepdr->clear();
 Jet_lepdrmax->clear();
 Jet_dilepdr->clear();
 Jet_bjdr->clear();
 Jet_nonjdeta->clear();
 Jet_nonjdilepdeta->clear();
 Jet_lepdetamin->clear();
 Jet_lepdetamax->clear();
 Jet_dilepdeta->clear();
 Jet_bjdeta->clear();
 Jet_nonjdphi->clear();
 Jet_nonjdilepdphi->clear();
 Jet_lepdphimin->clear();
 Jet_lepdphimax->clear();
 Jet_dilepdphi->clear();
 Jet_bjdphi->clear();
 Jet_nonjptratio->clear();
 Jet_nonjdilepptratio->clear();
 Jet_lepptratiomin->clear();
 Jet_lepptratiomax->clear();
 Jet_dilepptratio->clear();
 Jet_bjptratio->clear();
 EVENT_event= -999;
 EVENT_genWeight= -999;
 EVENT_xsecWeight= -999;
 num_Jet_matchLooseHJet= -999;
 num_Jet_matchMediumHJet= -999;
 num_Jet_matchTightHJet= -999;
 num_ishlep= -999;
 num_ishPair= -999;
 num_Gen_Leph= -999;
 num_Gen_Jeth= -999;
 num_Gen_Leptop= -999;
 num_Gen_Lvh= -999;
 num_Gen_Lvtop= -999;
 Jet_numLoose= -999;
 Met_type1PF_pt= -999;
 Met_type1PF_px= -999;
 Met_type1PF_py= -999;
 Met_type1PF_pz= -999;
 Met_type1PF_phi= -999;
 Gen_type1PF_Met= -999;
 Gen_pdg_id->clear();
 Gen_pt->clear();
 Gen_eta->clear();
 Gen_phi->clear();
 Gen_energy->clear();
 Gen_motherpdg_id->clear();
 Gen_BmotherIndex->clear();
 Gen_numMother->clear();
 Jet_BDT->clear();
 bdtJet_BDT->clear();
 bdtJet_ishighestcsv->clear();
 bdtJet_istophJet->clear();
 bdtJet_isLooseHJet->clear();
 bdtJet_isMediumHJet->clear();
 bdtJet_isTightHJet->clear();
 bdtJet_pt->clear();
 bdtJet_eta->clear();
 bdtJet_phi->clear();
 bdtJet_energy->clear();
 bdtJet_qg->clear();
 bdtJet_newpfCombinedInclusiveSecondaryVertexV2BJetTags->clear();
 bdtJet_lepdrmin->clear();
 bdtJet_pfCombinedMVAV2BJetTags->clear();
 bdtJet_lepdrmax->clear();
 FakeLep_ishlep->clear();
 FakeLep_ptoverlep->clear();
 FakeLep_ptovermetlep->clear();
 FakeLep_rlepdrjet0csv->clear();
 FakeLep_rlepdrjet0mass->clear();
 FakeLep_rlepdrjet0mt->clear();
 FakeLep_rlepdrjet1mass->clear();
 FakeLep_sumjetsdphi->clear();
 FakeLep_3toncsvjetsdphi->clear();
 FakeLep_csvjet2dr->clear();
 FakeLep_csvjet3dr->clear();
 FakeLep_metdphi->clear();
 FakeLep_metlepdphi->clear();
 FakeLep_minjetdr->clear();
 FakeLep_mt->clear();
 FakeLep_ptovermet->clear();
 FakeLep_rlepdrjet1mt->clear();
 FakeLep_sumjetsdr->clear();
 FakeLep_3toncsvjetsdr->clear();
 FakeLep_csvjet0mass->clear();
 FakeLep_csvjet1mass->clear();
 FakeLep_csvjet1mt->clear();
 FakeLep_csvjet2deta->clear();
 FakeLep_csvjet2dphi->clear();
 FakeLep_csvjet3deta->clear();
 FakeLep_csvjet3dphi->clear();
 FakeLep_metmt->clear();
 FakeLep_minjetdphi->clear();
 //LepTag
 FakeLep_bdt->clear();
 FakeLep_ishigherbdt->clear();
 //JetPair
 bdtJetPair_id->clear();
 bdtJetPair_pt->clear();
 bdtJetPair_eta->clear();
 bdtJetPair_phi->clear();
 bdtJetPair_energy->clear();
 bdtJetPair_ishPair->clear();
 bdtJetPair_dr->clear();
 bdtJetPair_deta->clear();
 bdtJetPair_dphi->clear();
 bdtJetPair_mass->clear();
 bdtJetPair_higestbdt->clear();
 bdtJetPair_sumcsv->clear();
 bdtJetPair_sumbdt->clear();
 bdtJetPair_sumqg->clear();
 bdtJetPair_ptratio->clear();
 bdtJetPair_WChi2->clear();
 bdtJetPair_minlepdr->clear();
 bdtJetPair_minlepdeta->clear();
 bdtJetPair_minlepdphi->clear();
 bdtJetPair_minlepmass->clear();
 bdtJetPair_minlepptratio->clear();
 bdtJetPair_maxlepdr->clear();
 bdtJetPair_maxlepdeta->clear();
 bdtJetPair_maxlepdphi->clear();
 bdtJetPair_maxlepmass->clear();
 bdtJetPair_maxlepptratio->clear();
 bdtJetPair_minjdr->clear();
 bdtJetPair_minjdeta->clear();
 bdtJetPair_minjdphi->clear();
 bdtJetPair_minjmass->clear();
 bdtJetPair_minjptratio->clear();
 bdtJetPair_maxjdr->clear();
 bdtJetPair_maxjdeta->clear();
 bdtJetPair_maxjdphi->clear();
 bdtJetPair_maxjmass->clear();
 bdtJetPair_maxjptratio->clear();
 bdtJetPair_remaincsvj0dr->clear();
 bdtJetPair_remaincsvj0deta->clear();
 bdtJetPair_remaincsvj0dphi->clear();
 bdtJetPair_remaincsvj0mass->clear();
 bdtJetPair_remaincsvj0ptratio->clear();
 bdtJetPair_remaincsvj1dr->clear();
 bdtJetPair_remaincsvj1deta->clear();
 bdtJetPair_remaincsvj1dphi->clear();
 bdtJetPair_remaincsvj1mass->clear();
 bdtJetPair_remaincsvj1ptratio->clear();
 bdtJetPair_minjOvermaxjdr->clear();
 bdtJetPair_jTopminChi2->clear();
 bdtJetPair_TopminChi2jpt->clear();
 bdtJetPair_hascsvj0->clear();
 bdtJetPair_hastophj->clear();
 bdtJetPair_BDT->clear();
 bdtJetPair_ismaxBDT->clear();
 bdtJetPair_minlepishlep->clear();
 bdtJetPair_minleppt->clear();
 bdtJetPair_minlepeta->clear();
 bdtJetPair_minlepphi->clear();
 bdtJetPair_minlepenergy->clear();
 bdtJetPair_minlepmotherIndex->clear();
 bdtJetPair_minlepmotherId->clear();
 bdtJetPair_minlvpt->clear();
 bdtJetPair_minlveta->clear();
 bdtJetPair_minlvphi->clear();
 bdtJetPair_minlvenergy->clear();
 bdtJetPair_minlvmotherIndex->clear();
 bdtJetPair_minlvmotherId->clear();
 bdtJetPair_maxlepishlep->clear();
 bdtJetPair_maxleppt->clear();
 bdtJetPair_maxlepeta->clear();
 bdtJetPair_maxlepphi->clear();
 bdtJetPair_maxlepenergy->clear();
 bdtJetPair_maxlepmotherIndex->clear();
 bdtJetPair_maxlepmotherId->clear();
 bdtJetPair_maxlvpt->clear();
 bdtJetPair_maxlveta->clear();
 bdtJetPair_maxlvphi->clear();
 bdtJetPair_maxlvenergy->clear();
 bdtJetPair_maxlvmotherIndex->clear();
 bdtJetPair_maxlvmotherId->clear();
 tagJetPair_j0bdt->clear();
 tagJetPair_j1bdt->clear();
 bdtJetPair_j0bdt->clear();
 bdtJetPair_j1bdt->clear();
 tagJetPair_ishPair->clear();
 tagJetPair_hascsvj0->clear();
 tagJetPair_hastophj->clear();
 tagJetPair_id->clear();
 tagJetPair_BDT->clear();
 tagJetPair_pt->clear();
 tagJetPair_mass->clear();
 tagJetPair_eta->clear();
 tagJetPair_phi->clear();
 tagJetPair_energy->clear();
 tagJetPair_dr->clear();
 tagJetPair_deta->clear();
 tagJetPair_dphi->clear();
 tagJetPair_ismaxBDT->clear();
 tagJetPair_higestbdt->clear();
 tagJetPair_sumcsv->clear();
 tagJetPair_sumbdt->clear();
 tagJetPair_sumqg->clear();
 tagJetPair_ptratio->clear();
 tagJetPair_WChi2->clear();
 tagJetPair_minlepdr->clear();
 tagJetPair_minlepdeta->clear();
 tagJetPair_minlepdphi->clear();
 tagJetPair_minlepmass->clear();
 tagJetPair_minlepptratio->clear();
 tagJetPair_maxlepdr->clear();
 tagJetPair_maxlepdeta->clear();
 tagJetPair_maxlepdphi->clear();
 tagJetPair_maxlepmass->clear();
 tagJetPair_maxlepptratio->clear();
 tagJetPair_minjdr->clear();
 tagJetPair_minjdeta->clear();
 tagJetPair_minjdphi->clear();
 tagJetPair_minjmass->clear();
 tagJetPair_minjptratio->clear();
 tagJetPair_maxjdr->clear();
 tagJetPair_maxjdeta->clear();
 tagJetPair_maxjdphi->clear();
 tagJetPair_maxjmass->clear();
 tagJetPair_maxjptratio->clear();
 tagJetPair_remaincsvj0dr->clear();
 tagJetPair_remaincsvj0deta->clear();
 tagJetPair_remaincsvj0dphi->clear();
 tagJetPair_remaincsvj0mass->clear();
 tagJetPair_remaincsvj0ptratio->clear();
 tagJetPair_remaincsvj1dr->clear();
 tagJetPair_remaincsvj1deta->clear();
 tagJetPair_remaincsvj1dphi->clear();
 tagJetPair_remaincsvj1mass->clear();
 tagJetPair_remaincsvj1ptratio->clear();
 tagJetPair_minjOvermaxjdr->clear();
 tagJetPair_jTopminChi2->clear();
 tagJetPair_TopminChi2jpt->clear();
 tagJetPair_minlepishlep->clear();
 tagJetPair_minleppt->clear();
 tagJetPair_minlepeta->clear();
 tagJetPair_minlepphi->clear();
 tagJetPair_minlepenergy->clear();
 tagJetPair_minlepmotherIndex->clear();
 tagJetPair_minlepmotherId->clear();
 tagJetPair_minlvpt->clear();
 tagJetPair_minlveta->clear();
 tagJetPair_minlvphi->clear();
 tagJetPair_minlvenergy->clear();
 tagJetPair_minlvmotherIndex->clear();
 tagJetPair_minlvmotherId->clear();
 tagJetPair_maxlepishlep->clear();
 tagJetPair_maxleppt->clear();
 tagJetPair_maxlepeta->clear();
 tagJetPair_maxlepphi->clear();
 tagJetPair_maxlepenergy->clear();
 tagJetPair_maxlepmotherIndex->clear();
 tagJetPair_maxlepmotherId->clear();
 tagJetPair_maxlvpt->clear();
 tagJetPair_maxlveta->clear();
 tagJetPair_maxlvphi->clear();
 tagJetPair_maxlvenergy->clear();
 tagJetPair_maxlvmotherIndex->clear();
 tagJetPair_maxlvmotherId->clear();
 //Regression
 H_Gen_massA= -999;
 H_Gen_massB= -999;
 H_Gen_massC= -999;
 RegLep_px= -999;
 RegLep_py= -999;
 RegLep_pz= -999;
 RegLep_eta= -999;
 RegLep_energy= -999;
 RegJetPair_px= -999;
 RegJetPair_py= -999;
 RegJetPair_pz= -999;
 RegJetPair_eta= -999;
 RegJetPair_energy= -999;
 RegHsys_px= -999;
 RegHsys_pt= -999;
 RegHsys_py= -999;
 RegHsys_pz= -999;
 RegHsys_eta= -999;
 RegHsys_energy= -999;
 RegHsys_mass= -999;
 RegMet= -999;
 RegPt_LepOverMet= -999;
 RegPt_LepOverJetPair= -999;
 RegPt_MetOverJetPair= -999;
 RegdR_LepJetPair= -999;
 Regdeta_LepJetPair= -999;
 Regdphi_LepJetPair= -999;
 RegPt_Lep1OverMet= -999;
 RegPt_Lep2OverMet= -999;
 Regdphi_Lep1Met= -999;
 Regdphi_Lep2Met= -999;
 GenLep_px= -999;
 GenLep_py= -999;
 GenLep_pz= -999;
 GenLep_eta= -999;
 GenLep_energy= -999;
 GenJetPair_px= -999;
 GenJetPair_py= -999;
 GenJetPair_pz= -999;
 GenJetPair_eta= -999;
 GenJetPair_energy= -999;
 GenHsys_px= -999;
 GenHsys_py= -999;
 GenHsys_pz= -999;
 GenHsys_eta= -999;
 GenHsys_energy= -999;
 GenHsys_mass= -999;
 GenMet= -999;
 GenPt_LepOverMet= -999;
 GenPt_LepOverJetPair= -999;
 GenPt_MetOverJetPair= -999;
 GendR_LepJetPair= -999;
 Gendeta_LepJetPair= -999;
 Gendphi_LepJetPair= -999;
 TargetH_mass= -999;
 TargetH_pt= -999;
 TargetH_eta= -999;
 TargetH_energy= -999;
 minljjv_pt= -999;
 minljjv_eta= -999;
 minljjv_phi= -999;
 minljjv_energy= -999;
 minljjv_mass= -999;
 minljjv_ishpair= -999;
 minljjv_ishlep= -999;
 maxljjv_pt= -999;
 maxljjv_eta= -999;
 maxljjv_phi= -999;
 maxljjv_energy= -999;
 maxljjv_mass= -999;
 maxljjv_ishpair= -999;
 maxljjv_ishlep= -999;
 genRegH_pt= -999;
 genRegH_eta= -999;
 genRegH_energy= -999;
 genRegH_mass= -999;
 maxRegH_pt= -999;
 maxRegH_eta= -999;
 maxRegH_energy= -999;
 maxRegH_mass= -999;
 minRegH_pt= -999;
 minRegH_eta= -999;
 minRegH_energy= -999;
 minRegH_mass= -999;
 minHsys_pt= -999;
 minHsys_eta= -999;
 minHsys_mass= -999;
 minHsys_energy= -999;
 minHsys_pz= -999;
 minHsys_px= -999;
 minHsys_py= -999;
 maxHsys_pt= -999;
 maxHsys_eta= -999;
 maxHsys_mass= -999;
 maxHsys_energy= -999;
 maxHsys_pz= -999;
 maxHsys_px= -999;
 maxHsys_py= -999;
//Train Regress Lv
 minlep_pt= -999;
 minlep_eta= -999;
 minlep_phi= -999;
 minlep_energy= -999;
 minlep_ptratioMet= -999;
 minlep_dphiMet= -999;
 maxlep_pt= -999;
 maxlep_eta= -999;
 maxlep_phi= -999;
 maxlep_energy= -999;
 maxlep_ptratioMet= -999;
 maxlep_dphiMet= -999;
 minlv_pt= -999;
 minlv_eta= -999;
 minlv_phi= -999;
 minlv_energy= -999;
 minReglv_pt= -999;
 minReglv_eta= -999;
 minReglv_phi= -999;
 minReglv_energy= -999;
 minljjReglv_mass= -999;
 Met_pt= -999;
 Met_phi= -999;
 jj_pt= -999;
 jj_eta= -999;
 jj_phi= -999;
 jj_energy= -999;
 jj_mass= -999;
 E_lXjj= -999;
 Pt_lXjjXmet= -999;
 ljj_cosTheta= -999;
 MT_ljjMet= -999;
 Meff_ljjMet= -999;
 Mtrue= -999;
 MTtot= -999;
 MT_lMet= -999;
 Mt_lMetOverM_jj= -999;
};
void rGetEntry(Long64_t tentry){
 b_rEVENT_event->GetEntry(tentry);
 b_rEVENT_genWeight->GetEntry(tentry);
 b_rnum_Jet_matchLooseHJet->GetEntry(tentry);
 b_rnum_Jet_matchMediumHJet->GetEntry(tentry);
 b_rnum_Jet_matchTightHJet->GetEntry(tentry);
 b_rnum_ishlep->GetEntry(tentry);
 b_rnum_Gen_Leph->GetEntry(tentry);
 b_rnum_Gen_Jeth->GetEntry(tentry);
 b_rnum_Gen_Leptop->GetEntry(tentry);
 b_rnum_Gen_Lvh->GetEntry(tentry);
 b_rnum_Gen_Lvtop->GetEntry(tentry);
 b_rJet_numLoose->GetEntry(tentry);
 b_rMet_type1PF_pt->GetEntry(tentry);
 b_rMet_type1PF_px->GetEntry(tentry);
 b_rMet_type1PF_py->GetEntry(tentry);
 b_rMet_type1PF_pz->GetEntry(tentry);
 b_rMet_type1PF_phi->GetEntry(tentry);
 b_rGen_type1PF_Met->GetEntry(tentry);
 b_rGen_pdg_id->GetEntry(tentry);
 b_rGen_pt->GetEntry(tentry);
 b_rGen_eta->GetEntry(tentry);
 b_rGen_phi->GetEntry(tentry);
 b_rGen_energy->GetEntry(tentry);
 b_rGen_motherpdg_id->GetEntry(tentry);
 b_rGen_BmotherIndex->GetEntry(tentry);
 b_rGen_numMother->GetEntry(tentry);
 b_rFakeLep_pt->GetEntry(tentry);
 b_rFakeLep_eta->GetEntry(tentry);
 b_rFakeLep_phi->GetEntry(tentry);
 b_rFakeLep_energy->GetEntry(tentry);
 b_rcsvJet_isMediumHJet->GetEntry(tentry);
 b_rcsvJet_partonFlavour->GetEntry(tentry);
 b_rcsvJet_pt->GetEntry(tentry);
 b_rcsvJet_eta->GetEntry(tentry);
 b_rcsvJet_phi->GetEntry(tentry);
 b_rcsvJet_energy->GetEntry(tentry);
 b_rJet_lepdrmin->GetEntry(tentry);
 b_rJet_pt->GetEntry(tentry);
 b_rJet_eta->GetEntry(tentry);
 b_rJet_phi->GetEntry(tentry);
 b_rJet_energy->GetEntry(tentry);
 b_rJet_partonFlavour->GetEntry(tentry);
 b_rJet_px->GetEntry(tentry);
 b_rJet_py->GetEntry(tentry);
 b_rJet_pz->GetEntry(tentry);
 b_rJet_mass->GetEntry(tentry);
 b_rJet_newpfCombinedInclusiveSecondaryVertexV2BJetTags->GetEntry(tentry);
 b_rJet_pfCombinedInclusiveSecondaryVertexV2BJetTags->GetEntry(tentry);
 b_rJet_isLooseHJet->GetEntry(tentry);
 b_rJet_isMediumHJet->GetEntry(tentry);
 b_rJet_isTightHJet->GetEntry(tentry);
 b_rJet_dRGenJeth->GetEntry(tentry);
 b_rJet_pfCombinedMVAV2BJetTags->GetEntry(tentry);
 b_rJet_pfJetProbabilityBJetTags->GetEntry(tentry);
 b_rJet_pileupId->GetEntry(tentry);
 b_rJet_neutralHadEnergyFraction->GetEntry(tentry);
 b_rJet_neutralEmEnergyFraction->GetEntry(tentry);
 b_rJet_chargedHadronEnergyFraction->GetEntry(tentry);
 b_rJet_chargedEmEnergyFraction->GetEntry(tentry);
 b_rJet_muonEnergyFraction->GetEntry(tentry);
 b_rJet_electronEnergy->GetEntry(tentry);
 b_rJet_photonEnergy->GetEntry(tentry);
 b_rJet_emEnergyFraction->GetEntry(tentry);
 b_rJet_numberOfConstituents->GetEntry(tentry);
 b_rJet_chargedMultiplicity->GetEntry(tentry);
 b_rJet_vtxMass->GetEntry(tentry);
 b_rJet_vtxNtracks->GetEntry(tentry);
 b_rJet_vtx3DVal->GetEntry(tentry);
 b_rJet_vtx3DSig->GetEntry(tentry);
 b_rJet_ishighestcsv->GetEntry(tentry);
 b_rJet_istophJet->GetEntry(tentry);
 b_rJet_metptratio->GetEntry(tentry);
 b_rJet_dilepmetptratio->GetEntry(tentry);
 b_rJet_nonjdr->GetEntry(tentry);
 b_rJet_nonjdilepdr->GetEntry(tentry);
 b_rJet_lepdrmax->GetEntry(tentry);
 b_rJet_dilepdr->GetEntry(tentry);
 b_rJet_bjdr->GetEntry(tentry);
 b_rJet_nonjdeta->GetEntry(tentry);
 b_rJet_nonjdilepdeta->GetEntry(tentry);
 b_rJet_lepdetamin->GetEntry(tentry);
 b_rJet_lepdetamax->GetEntry(tentry);
 b_rJet_dilepdeta->GetEntry(tentry);
 b_rJet_bjdeta->GetEntry(tentry);
 b_rJet_nonjdphi->GetEntry(tentry);
 b_rJet_nonjdilepdphi->GetEntry(tentry);
 b_rJet_lepdphimin->GetEntry(tentry);
 b_rJet_lepdphimax->GetEntry(tentry);
 b_rJet_dilepdphi->GetEntry(tentry);
 b_rJet_bjdphi->GetEntry(tentry);
 b_rJet_nonjptratio->GetEntry(tentry);
 b_rJet_nonjdilepptratio->GetEntry(tentry);
 b_rJet_lepptratiomin->GetEntry(tentry);
 b_rJet_lepptratiomax->GetEntry(tentry);
 b_rJet_dilepptratio->GetEntry(tentry);
 b_rJet_bjptratio->GetEntry(tentry);
 b_rFakeLep_ishlep->GetEntry(tentry);
 b_rFakeLep_ptoverlep->GetEntry(tentry);
 b_rFakeLep_ptovermetlep->GetEntry(tentry);
 b_rFakeLep_rlepdrjet0csv->GetEntry(tentry);
 b_rFakeLep_rlepdrjet0mass->GetEntry(tentry);
 b_rFakeLep_rlepdrjet0mt->GetEntry(tentry);
 b_rFakeLep_rlepdrjet1mass->GetEntry(tentry);
 b_rFakeLep_sumjetsdphi->GetEntry(tentry);
 b_rFakeLep_3toncsvjetsdphi->GetEntry(tentry);
 b_rFakeLep_csvjet2dr->GetEntry(tentry);
 b_rFakeLep_csvjet3dr->GetEntry(tentry);
 b_rFakeLep_metdphi->GetEntry(tentry);
 b_rFakeLep_metlepdphi->GetEntry(tentry);
 b_rFakeLep_minjetdr->GetEntry(tentry);
 b_rFakeLep_mt->GetEntry(tentry);
 b_rFakeLep_ptovermet->GetEntry(tentry);
 b_rFakeLep_rlepdrjet1mt->GetEntry(tentry);
 b_rFakeLep_sumjetsdr->GetEntry(tentry);
 b_rFakeLep_3toncsvjetsdr->GetEntry(tentry);
 b_rFakeLep_csvjet0mass->GetEntry(tentry);
 b_rFakeLep_csvjet1mass->GetEntry(tentry);
 b_rFakeLep_csvjet1mt->GetEntry(tentry);
 b_rFakeLep_csvjet2deta->GetEntry(tentry);
 b_rFakeLep_csvjet2dphi->GetEntry(tentry);
 b_rFakeLep_csvjet3deta->GetEntry(tentry);
 b_rFakeLep_csvjet3dphi->GetEntry(tentry);
 b_rFakeLep_metmt->GetEntry(tentry);
 b_rFakeLep_minjetdphi->GetEntry(tentry);
 b_rJet_qg->GetEntry(tentry);
 b_rJet_axis2->GetEntry(tentry);
 b_rJet_ptD->GetEntry(tentry);
 b_rJet_mult->GetEntry(tentry);
 b_rH_Gen_pt->GetEntry(tentry);
 b_rH_Gen_eta->GetEntry(tentry);
 b_rH_Gen_phi->GetEntry(tentry);
 b_rH_Gen_energy->GetEntry(tentry);
 b_rJeth_Gen_pt->GetEntry(tentry);
 b_rJeth_Gen_eta->GetEntry(tentry);
 b_rJeth_Gen_phi->GetEntry(tentry);
 b_rJeth_Gen_energy->GetEntry(tentry);
 b_rLeph_Gen_pt->GetEntry(tentry);
 b_rLeph_Gen_eta->GetEntry(tentry);
 b_rLeph_Gen_phi->GetEntry(tentry);
 b_rLeph_Gen_energy->GetEntry(tentry);
 b_rLeph_Gen_Id->GetEntry(tentry);
 b_rLvh_Gen_pt->GetEntry(tentry);
 b_rLvh_Gen_eta->GetEntry(tentry);
 b_rLvh_Gen_phi->GetEntry(tentry);
 b_rLvh_Gen_energy->GetEntry(tentry);
 b_rLvh_Gen_Id->GetEntry(tentry);
 b_rLvtop_Gen_pt->GetEntry(tentry);
 b_rLvtop_Gen_eta->GetEntry(tentry);
 b_rLvtop_Gen_phi->GetEntry(tentry);
 b_rLvtop_Gen_energy->GetEntry(tentry);
 b_rLvtop_Gen_Id->GetEntry(tentry);
};
void wBranch(){
 EVENT_event = rEVENT_event;
 EVENT_genWeight = rEVENT_genWeight;
 EVENT_xsecWeight = evtwgt;
 num_Jet_matchLooseHJet = rnum_Jet_matchLooseHJet;
 num_Jet_matchMediumHJet = rnum_Jet_matchMediumHJet;
 num_Jet_matchTightHJet = rnum_Jet_matchTightHJet;
 num_ishlep = rnum_ishlep;
 num_Gen_Leph = rnum_Gen_Leph;
 num_Gen_Jeth = rnum_Gen_Jeth;
 num_Gen_Leptop = rnum_Gen_Leptop;
 num_Gen_Lvh = rnum_Gen_Lvh;
 num_Gen_Lvtop = rnum_Gen_Lvtop;
 Jet_numLoose = rJet_numLoose;
 Met_type1PF_pt = rMet_type1PF_pt;
 Met_type1PF_px = rMet_type1PF_px;
 Met_type1PF_py = rMet_type1PF_py;
 Met_type1PF_pz = rMet_type1PF_pz;
 Met_type1PF_phi = rMet_type1PF_phi;
 Gen_type1PF_Met = rGen_type1PF_Met;
 for(uint gen_en=0; gen_en<rGen_pt->size();gen_en++){
  Gen_pdg_id->push_back(rGen_pdg_id->at(gen_en));
  Gen_pt->push_back(rGen_pt->at(gen_en));
  Gen_eta->push_back(rGen_eta->at(gen_en));
  Gen_phi->push_back(rGen_phi->at(gen_en));
  Gen_energy->push_back(rGen_energy->at(gen_en));
  Gen_motherpdg_id->push_back(rGen_motherpdg_id->at(gen_en));
  Gen_BmotherIndex->push_back(rGen_BmotherIndex->at(gen_en));
  Gen_numMother->push_back(rGen_numMother->at(gen_en));
 }
 for(uint lep_en=0; lep_en<rFakeLep_pt->size();lep_en++){ 
  FakeLep_pt->push_back(rFakeLep_pt->at(lep_en));
  FakeLep_eta->push_back(rFakeLep_eta->at(lep_en));
  FakeLep_phi->push_back(rFakeLep_phi->at(lep_en));
  FakeLep_energy->push_back(rFakeLep_energy->at(lep_en));
  if(lep_en<2){
   FakeLep_ishlep->push_back(rFakeLep_ishlep->at(lep_en));
   FakeLep_ptoverlep->push_back(rFakeLep_ptoverlep->at(lep_en));
   FakeLep_ptovermetlep->push_back(rFakeLep_ptovermetlep->at(lep_en));
   FakeLep_rlepdrjet0csv->push_back(rFakeLep_rlepdrjet0csv->at(lep_en));
   FakeLep_rlepdrjet0mass->push_back(rFakeLep_rlepdrjet0mass->at(lep_en));
   FakeLep_rlepdrjet0mt->push_back(rFakeLep_rlepdrjet0mt->at(lep_en));
   FakeLep_rlepdrjet1mass->push_back(rFakeLep_rlepdrjet1mass->at(lep_en));
   FakeLep_sumjetsdphi->push_back(rFakeLep_sumjetsdphi->at(lep_en));
   FakeLep_3toncsvjetsdphi->push_back(rFakeLep_3toncsvjetsdphi->at(lep_en));
   FakeLep_csvjet2dr->push_back(rFakeLep_csvjet2dr->at(lep_en));
   FakeLep_csvjet3dr->push_back(rFakeLep_csvjet3dr->at(lep_en));
   FakeLep_metdphi->push_back(rFakeLep_metdphi->at(lep_en));
   FakeLep_metlepdphi->push_back(rFakeLep_metlepdphi->at(lep_en));
   FakeLep_minjetdr->push_back(rFakeLep_minjetdr->at(lep_en));
   FakeLep_mt->push_back(rFakeLep_mt->at(lep_en));
   FakeLep_ptovermet->push_back(rFakeLep_ptovermet->at(lep_en));
   FakeLep_rlepdrjet1mt->push_back(rFakeLep_rlepdrjet1mt->at(lep_en));
   FakeLep_sumjetsdr->push_back(rFakeLep_sumjetsdr->at(lep_en));
   FakeLep_3toncsvjetsdr->push_back(rFakeLep_3toncsvjetsdr->at(lep_en));
   FakeLep_csvjet0mass->push_back(rFakeLep_csvjet0mass->at(lep_en));
   FakeLep_csvjet1mass->push_back(rFakeLep_csvjet1mass->at(lep_en));
   FakeLep_csvjet1mt->push_back(rFakeLep_csvjet1mt->at(lep_en));
   FakeLep_csvjet2deta->push_back(rFakeLep_csvjet2deta->at(lep_en));
   FakeLep_csvjet2dphi->push_back(rFakeLep_csvjet2dphi->at(lep_en));
   FakeLep_csvjet3deta->push_back(rFakeLep_csvjet3deta->at(lep_en));
   FakeLep_csvjet3dphi->push_back(rFakeLep_csvjet3dphi->at(lep_en));
   FakeLep_metmt->push_back(rFakeLep_metmt->at(lep_en));
   FakeLep_minjetdphi->push_back(rFakeLep_minjetdphi->at(lep_en));
  }
 } 
 for(uint cjet_en=0; cjet_en<rcsvJet_partonFlavour->size();cjet_en++){ 
  csvJet_isMediumHJet->push_back(rcsvJet_isMediumHJet->at(cjet_en));
  csvJet_partonFlavour->push_back(rcsvJet_partonFlavour->at(cjet_en));
  csvJet_pt->push_back(rcsvJet_pt->at(cjet_en));
  csvJet_eta->push_back(rcsvJet_eta->at(cjet_en));
  csvJet_phi->push_back(rcsvJet_phi->at(cjet_en));
  csvJet_energy->push_back(rcsvJet_energy->at(cjet_en));
 }
 for(uint jet_en=0; jet_en<rJet_pt->size();jet_en++){ 
  Jet_lepdrmin->push_back(rJet_lepdrmin->at(jet_en));
  Jet_pt->push_back(rJet_pt->at(jet_en));
  Jet_eta->push_back(rJet_eta->at(jet_en));
  Jet_phi->push_back(rJet_phi->at(jet_en));
  Jet_energy->push_back(rJet_energy->at(jet_en));
  Jet_partonFlavour->push_back(rJet_partonFlavour->at(jet_en));
  Jet_px->push_back(rJet_px->at(jet_en));
  Jet_py->push_back(rJet_py->at(jet_en));
  Jet_pz->push_back(rJet_pz->at(jet_en));
  Jet_mass->push_back(rJet_mass->at(jet_en));
  Jet_newpfCombinedInclusiveSecondaryVertexV2BJetTags->push_back(rJet_newpfCombinedInclusiveSecondaryVertexV2BJetTags->at(jet_en));
  Jet_pfCombinedInclusiveSecondaryVertexV2BJetTags->push_back(rJet_pfCombinedInclusiveSecondaryVertexV2BJetTags->at(jet_en));
  Jet_isLooseHJet->push_back(rJet_isLooseHJet->at(jet_en));
  Jet_isMediumHJet->push_back(rJet_isMediumHJet->at(jet_en));
  Jet_isTightHJet->push_back(rJet_isTightHJet->at(jet_en));
  Jet_dRGenJeth->push_back(rJet_dRGenJeth->at(jet_en));
  Jet_pfCombinedMVAV2BJetTags->push_back(rJet_pfCombinedMVAV2BJetTags->at(jet_en));
  Jet_pfJetProbabilityBJetTags->push_back(rJet_pfJetProbabilityBJetTags->at(jet_en));
  Jet_pileupId->push_back(rJet_pileupId->at(jet_en));
  Jet_neutralHadEnergyFraction->push_back(rJet_neutralHadEnergyFraction->at(jet_en));
  Jet_neutralEmEnergyFraction->push_back(rJet_neutralEmEnergyFraction->at(jet_en));
  Jet_chargedHadronEnergyFraction->push_back(rJet_chargedHadronEnergyFraction->at(jet_en));
  Jet_chargedEmEnergyFraction->push_back(rJet_chargedEmEnergyFraction->at(jet_en));
  Jet_muonEnergyFraction->push_back(rJet_muonEnergyFraction->at(jet_en));
  Jet_electronEnergy->push_back(rJet_electronEnergy->at(jet_en));
  Jet_photonEnergy->push_back(rJet_photonEnergy->at(jet_en));
  Jet_emEnergyFraction->push_back(rJet_emEnergyFraction->at(jet_en));
  Jet_numberOfConstituents->push_back(rJet_numberOfConstituents->at(jet_en));
  Jet_chargedMultiplicity->push_back(rJet_chargedMultiplicity->at(jet_en));
  Jet_vtxMass->push_back(rJet_vtxMass->at(jet_en));
  Jet_vtxNtracks->push_back(rJet_vtxNtracks->at(jet_en));
  Jet_vtx3DVal->push_back(rJet_vtx3DVal->at(jet_en));
  Jet_vtx3DSig->push_back(rJet_vtx3DSig->at(jet_en));
  Jet_ishighestcsv->push_back(rJet_ishighestcsv->at(jet_en));
  Jet_istophJet->push_back(rJet_istophJet->at(jet_en));
  Jet_metptratio->push_back(rJet_metptratio->at(jet_en));
  Jet_dilepmetptratio->push_back(rJet_dilepmetptratio->at(jet_en));
  Jet_nonjdr->push_back(rJet_nonjdr->at(jet_en));
  Jet_nonjdilepdr->push_back(rJet_nonjdilepdr->at(jet_en));
  Jet_lepdrmax->push_back(rJet_lepdrmax->at(jet_en));
  Jet_dilepdr->push_back(rJet_dilepdr->at(jet_en));
  Jet_bjdr->push_back(rJet_bjdr->at(jet_en));
  Jet_nonjdeta->push_back(rJet_nonjdeta->at(jet_en));
  Jet_nonjdilepdeta->push_back(rJet_nonjdilepdeta->at(jet_en));
  Jet_lepdetamin->push_back(rJet_lepdetamin->at(jet_en));
  Jet_lepdetamax->push_back(rJet_lepdetamax->at(jet_en));
  Jet_dilepdeta->push_back(rJet_dilepdeta->at(jet_en));
  Jet_bjdeta->push_back(rJet_bjdeta->at(jet_en));
  Jet_nonjdphi->push_back(rJet_nonjdphi->at(jet_en));
  Jet_nonjdilepdphi->push_back(rJet_nonjdilepdphi->at(jet_en));
  Jet_lepdphimin->push_back(rJet_lepdphimin->at(jet_en));
  Jet_lepdphimax->push_back(rJet_lepdphimax->at(jet_en));
  Jet_dilepdphi->push_back(rJet_dilepdphi->at(jet_en));
  Jet_bjdphi->push_back(rJet_bjdphi->at(jet_en));
  Jet_nonjptratio->push_back(rJet_nonjptratio->at(jet_en));
  Jet_nonjdilepptratio->push_back(rJet_nonjdilepptratio->at(jet_en));
  Jet_lepptratiomin->push_back(rJet_lepptratiomin->at(jet_en));
  Jet_lepptratiomax->push_back(rJet_lepptratiomax->at(jet_en));
  Jet_dilepptratio->push_back(rJet_dilepptratio->at(jet_en));
  Jet_bjptratio->push_back(rJet_bjptratio->at(jet_en));
  Jet_qg->push_back(rJet_qg->at(jet_en));
  Jet_axis2->push_back(rJet_axis2->at(jet_en));
  Jet_ptD->push_back(rJet_ptD->at(jet_en));
  Jet_mult->push_back(rJet_mult->at(jet_en));
 }
};
void HBDTsync(){
  cout<<setiosflags(ios::fixed)<<setprecision(5);
  cout << rEVENT_event << " "<< Jet_lepdrmin->at(0)<<" "<< Jet_pfCombinedInclusiveSecondaryVertexV2BJetTags->at(0)<<" "<< Jet_qg->at(0) <<" "<< Jet_lepdrmax->at(0)<<" "<< Jet_pt->at(0) <<" "<<Jet_BDT->at(0) << " " << bdtJetPair_minlepmass->at(0) <<" "<< bdtJetPair_sumbdt->at(0)<<" "<<bdtJetPair_dr->at(0)<<" "<<bdtJetPair_minjdr->at(0) <<" "<<bdtJetPair_mass->at(0)<<" "<<bdtJetPair_minjOvermaxjdr->at(0)<<" "<<bdtJetPair_BDT->at(0)<< endl;
};
